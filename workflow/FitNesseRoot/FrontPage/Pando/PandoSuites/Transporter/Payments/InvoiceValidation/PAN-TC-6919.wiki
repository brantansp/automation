---
Help: Verify the application by clicking checked,return,resubmit,Reject and Approve Primary movement
Suites: srf
Test
---
!** Enable Permissions in Nimbus
!5 approve_invoice_primary
!5 return_invoice_primary  
!5 check_invoice_primary  
!5 accounts_reject_invoice_primary
!5 invoice_two_step_approval
**!

!* Test Coverage
!5 1. Create indent 1, deliver indent,CHECK invoice in Shipper, REJECT invoice in Shipper and verify GENERATED in Transporter,REJECTED in Shipper
!5 2. Create indent 2, deliver indent,RETURN invoice in Shipper, RESUBMIT invoice in Transporter with edited values, CHECK invoice in Shipper,APPROVE invoice in Shipper and verify APPROVED in both Shipper and Transporter
**!

!**> Unique values assignment
!|Script            |DateUtil                               |
|$unique=           |getCurrentDateTimeStamp;|yMMddHHmmss   |
|$truckoutdate=     |dateCalculation;        |yyyy/MM/dd |-1|
|$rdate=            |dateCalculation;        |yyyy/MM/dd |0 |
|$contractDate=     |dateCalculation;        |dd-MMM-yyyy|2 |
|$monthAndYear=     |dateCalculation;        |MMMM yyyy  |0 |
|$todayDate=        |dateCalculation;        |d          |0 |
|$ordinalDateSuffix=|getOrdinalDateSuffix;   |$todayDate    |
|$indate=           |getCurrentDateTimeStamp;|yyyy/MM/dd    |
|$indate2=          |dateCalculation;        |yyyy-MM-dd |0 |
|$vechicle_req_date=|dateCalculation;        |yyyy/MM/dd |-6|
|$newinvdate=       |dateCalculation;        |yyyy-MM-dd |-1|
|$newinvdate2=      |dateCalculation;        |dd MMM yyyy|0 |
|$newinvdate3=      |dateCalculation;        |d MMM yyyy |0 |

|Script             |Common                                              |
|$truckoutdate=     |stringConcatenation;|$truckoutdate     |!- $timer -!|
|$vechicle_req_date=|stringConcatenation;|$vechicle_req_date|!- $timer -!|
|$rdate=            |stringConcatenation;|$rdate            |!- $timer -!|
|$num=              |getRandomNumber;    |100000            |999999      |

!|Script            |DateUtil                                  |
|$truckoutdate=     |utcConversion;         |$truckoutdate     |
|$rdate=            |utcConversion;         |$rdate            |
|$vechicle_req_date=|utcConversion;         |$vechicle_req_date|
|$loadingDate=      |getCurrentDateTimeStamp|iso               |
**!

!**> Data Creation for Primary movement
!**> Source Depot Creation
!define depot_name {src$unique}
!define depot_state {Tamil Nadu}
!define depot_city {s$unique}
!define depot_region {South}
!define depot_short_code {s$num}
!define depot_reference_id {s$unique}
!define depot_address {No 15,GST Street}
!define depot_pincode {123456}
!define depot_gstn_no {123}
!define depot_delivery_type {1}
!define depot_phone {123}
!define gname {Gate 1}
!define grefid {SG1$unique}
!define g_user_email {pandoindent+1$unique@gmail.com}

!include -c .FrontPage.Pando.Common.CommonDepoCreationWithGate

!|script         |common           |
|$location_id=   |getTrim;|$depot  |
|$source_gate_id=|getTrim;|$gate_id|
*!

!**> Destination Depot Creation
!define depot_name {dest$unique}
!define depot_state {Haryana}
!define depot_city {d$unique}
!define depot_region {South}
!define depot_short_code {d$num}
!define depot_reference_id {dr$unique}
!define depot_address {No 15,GST Street}
!define depot_pincode {123456}
!define depot_gstn_no {123}
!define depot_delivery_type {1}
!define depot_phone {123}
!define gname {Gate 1}
!define grefid {DG1$unique}
!define g_user_email {pandoindent+2$unique@gmail.com}

!include -c .FrontPage.Pando.Common.CommonDepoCreationWithGate

!|script                       |common           |
|$destination_location_id=     |getTrim;|$depot  |
|$destination_gate_location_id=|getTrim;|$gate_id|
*!

!**> Material Creation
!define material_name {m$unique}
!define material_code {mc$unique}

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.DataManager.MaterialCreationAPI
**!

!**> Vehicle Creation
!define vehicle_name {v$unique MRT}
!define cft {965}
!define kg {1000}
!define vehicle_type {FTL}

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.DataManager.VehicleCreationAPI
*!

!**> Transporter Creation for Indent
!define transporter_name {t$unique}
!define transporter_ref_id {tr$unique}
!define address {Ashok Nagar}
!define city {Chennai}
!define state {Tamil Nadu}
!define pincode {600083}
!define manager_name {Manager $unique}
!define manager_mobile {123}
!define manager_email {pandotransporter+$unique@outlook.com}
!define pancard {AUYPD33324L}

!|script|common                                                                                                                                                                                                                                                                                                                                                                                        |
|$data= |getTrim;|{"data":{"name":"${transporter_name}","gst_type":1,"gst_percentage":"10","reference_id":"${transporter_ref_id}","discount":"0","status":${transporter_status},"country":"India","users":[{"name":"${manager_name}","phone":"${manager_mobile}","email":"${manager_email}"}],"address":"${address}","city":"${city}","pincode":"${pincode}","state":"${state}","pan_no":"${pancard}"}}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.DataManager.TransporterCreationDynamicAPI
*!

!**> Retrieving Password for the Created Transporter 
!include -c .FrontPage.Pando.Common.CommonTransporterPassword
*!

!**> Rate Matrix upload
!define row {Type*,Source*,Destination*,Vehicle Type*,Distance,Transporter Reference ID*,Transporter Name,Transit Days*,Freight Rate*,Freight Unit*,Valid From*,Valid To*,Minimum Rate,Multiplying Factor,Detention Group,Product Category,Fixed Rate,ODA Rate,Oda Unit,Minimum ODA,Point Charges,Is Dedicated,Truck Count,Slab Kms,Min Kms,Additional Charge Percentage,Hilly Region Addition Percentage,Is Round Trip Eligible,Return Freight Rate,Exclude,Trip Count,BDR Charge,BDR Label}
!define column {City,s$unique,d$unique,${vehicle_name},100,tr$unique,t$unique,1,5000,per_trip,01-Jan-2019,$contractDate,100,1,P}

!include -c .FrontPage.Pando.Common.RateMatrix
*!
**!

!**> Indent Creation 1 and mark as delivered
!**> Indent Creation 1
!define order_type  {0}
!define transporter_id {$transporter_id}
!define vehicle_type_id {$vehicle_id}
!define location_id {$location_id}
!define gate_id {$source_gate_id}
!define vehicle_requirement_date {$vechicle_req_date}
!define loader_available {false}
!define add_to_invoice {false}
!define indent_type {2}
!define destination_location_id {$destination_location_id}
!define sold_to_id {$destination_gate_location_id}
!define unloader_available {false}
!define expected_delivery_at {$expected_date}

!|script|common                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|$data= |getTrim;|{"data":{"order_type":${order_type},"transporter_id":"${transporter_id}","vehicle_type_id":"${vehicle_type_id}","sources":[{"type":1,"location_id":"${location_id}","gate_id":"${gate_id}","vehicle_requirement_date":"${vehicle_requirement_date}","loader_available":${loader_available},"add_to_invoice":${add_to_invoice}}],"destinations":[{"type":1,"location_id":"${destination_location_id}","source_location_id":"${location_id}","source_gate_id":"${gate_id}","sold_to_id":"${sold_to_id}","unloader_available":${unloader_available},"add_to_invoice":${add_to_invoice},"gate_id":"${sold_to_id}"}],"no_of_vehicles": 1}}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Indent.IndentCreationDynamicAPI
*!

!**> validating and Assinging The Truck
!define vechicle_number {tn 09 AT 9013}
!define driver_name  {pay driver}
!define phone_number  {123}
!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Indent.TruckAssignAPI
**!

!**> Create Material invoice 
!define mrp_price {1000}
!define quantity1 {10} 
!define quantity_unit {cases}
!define weight {400}
!define weight_unit {KG}
!define volume {1000}
!define volume_unit {CFT}
!define type {PRIMARY}
!define invoice_amount {20000}
!define invoice_date {$indate}
!define category {}
!define truck_out {$truckoutdate}

!|script|common                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|$data= |getTrim;|{ "data": [ { "indent_no": "$order_id", "delivery_number": "${delivery_number}", "mrp_price": "${mrp_price}", "material_code": "${material_code}", "depot_ref_id": "s$unique", "gate_ref_id": "SG1$unique", "division": "BK", "quantity": "${quantity1}", "quantity_unit": "${quantity_unit}", "weight": "${weight}", "weight_unit": "${weight_unit}", "volume": "${volume}", "volume_unit": "${volume_unit}", "ship_to": "DG1$unique", "sold_to": "DG1$unique", "type": "${type}", "invoice_number": "${invoice_number}", "invoice_amount": "${invoice_amount}", "invoice_date": "${invoice_date}","category": "","truck_out": "${truck_out}" }] }|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.ERPIntegration.MaterialInvoiceDynamicERPAPI
**!

!**> Marking Indent as delivered
!define consignee_id {$destination_location_id}
!define arrived_at {$loadingDate}
!define dispatched_at {$loadingDate}

!|script|common                                                                                                                |
|$data= |getTrim;|{"data":[{"destination_id":"${consignee_id}","reported_at":"${arrived_at}","release_at":"${dispatched_at}"}]}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Indent.MarkAsDeliveredAPI
*!
**!

!**> Transporter Login
!define transporter_email {pandotransporter+$unique@outlook.com}
!define transporter_password {$password}

!include -c .FrontPage.Pando.Common.TransporterLogin
*!

!**> Enabling Lorry Receipt
!define indent_id {$order_id}
!define tusername {${transporter_email}}
!define tpassword {${transporter_password}}
!|script|common                                                                                                                                                        |
|$data= |getTrim;|{"data":[{"destination_id":"${destination_location_id}","source_location_id":"${location_id}","lr_number":"${lr_number}","document_available":true}]}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.TransporterAPI.LorryReceiptAPI
*!

!** Validating indent 1 in Ready for billing page with Tax Invoice
!*> Ready for billing page
!define depot_name {src$unique}

!|Script  |Common                                          |
|$pdfpath=|getPath;|testAttachment/pdf_$unique.pdf|fullpath|

!|Script               |FileUtil           |
|createFileFromContent;|$pdfpath|test|UTF-8|

!define lr_copy {$pdfpath}
!include -c .FrontPage.Pando.Common.CommonPDFUploadInReadyForBilling
*!

!* Invoice Page
!define invoice_number {ic$unique}

!include -c .FrontPage.Pando.Common.CommonInvoiceGeneration
*!
**!

!** Invoice Filter
!include -c .FrontPage.Pando.Common.ShipperInvoiceFilter
**!

!*> Click Checked in Invoice
!|Script                        |Ui                                                                                                                                                             |
|click;                         |//span[contains(text(),'${transporter_name}')]                         |xpath                                                                                  |
|refresh;                                                                                                                                                                                       |
|waitForElementToBeDisplayed;   |//div[contains(@class,'scrolling')]                                    |xpath                                                                  |45             |
|click;                         |//button[contains(text(),'Summary')]                                   |xpath                                                                                  |
|click;                         |//button/span[contains(text(),'Checked')]                              |xpath                                                                                  |
|click;                         |//button/span[normalize-space(text())='YES']                           |xpath                                                                                  |
|waitForElementToBeDisplayed;   |//div[@role='alert']//h3[text()='Success']                             |xpath                                                                  |30             |
|$successMessage=               |getElementAttribute;                                                   |//div[@role='alert']//h3[text()='Success']/following-sibling::span     |xpath|innerText|
|waitForElementToDisappear;     |//div[@role='alert']//h3[text()='Success']                             |xpath                                                                  |10             |
|refreshForElementToBeDisplayed;|//span[contains(@class,'status') and normalize-space(text())='Checked']|findBy                                                                 |2    |5        |
|check                          |isElementPresent;                                                      |//span[contains(@class,'status') and normalize-space(text())='Checked']|xpath|true     |
|$tresult1=                     |isElementPresent;                                                      |//span[contains(@class,'status') and normalize-space(text())='Checked']|xpath          |

!|Script   |common                                                      |
|check     |checkIfStringAreEqual;|$successMessage|Invoice Checked!|true|
|$tresult2=|checkIfStringAreEqual;|$successMessage|Invoice Checked!     |
**!

!*> Click Reject in Invoice after checking
!|Script                        |Ui                                                                                                                                                                |
|click;                         |//span[contains(text(),'${transporter_name}')]                          |xpath                                                                                    |
|refresh;                                                                                                                                                                                          |
|waitForElementToBeDisplayed;   |//div[contains(@class,'scrolling')]                                     |xpath                                                                   |45              |
|click;                         |//button[contains(text(),'Summary')]                                    |xpath                                                                                    |
|click;                         |//button/span[contains(text(),'Reject')]                                |xpath                                                                                    |
|sendKeys;                      |//textarea[@placeholder='REMARKS']                                      |xpath                                                                   |Rejected $unique|
|click;                         |//button[text()='REJECT']                                               |xpath                                                                                    |
|waitForElementToBeDisplayed;   |//div[@role='alert']//h3[text()='Success']                              |xpath                                                                   |30              |
|$successMessage=               |getElementAttribute;                                                    |//div[@role='alert']//h3[text()='Success']/following-sibling::span      |xpath |innerText|
|refreshForElementToBeDisplayed;|//span[contains(@class,'status') and normalize-space(text())='Rejected']|findBy                                                                  |2     |5        |
|check                          |isElementPresent;                                                       |//span[contains(@class,'status') and normalize-space(text())='Rejected']|xpath |true     |
|$tresult3=                     |isElementPresent;                                                       |//span[contains(@class,'status') and normalize-space(text())='Rejected']|xpath           |

!|Script   |common                                                       |
|check     |checkIfStringAreEqual;|$successMessage|Invoice Rejected!|true|
|$tresult4=|checkIfStringAreEqual;|$successMessage|Invoice Rejected!     |
**!

!**> Validating invoices 
!include -c .FrontPage.Pando.Common.CommonTransporterInvoiceFilter

!|Script   |Ui                                                                                                    |
|check     |isElementPresent;|//span[contains(@class,'status') and normalize-space(text())='Generated']|xpath|true|
|$tresult5=|isElementPresent;|//span[contains(@class,'status') and normalize-space(text())='Generated']|xpath     |
**!

!**> Validating result
!|Script         |Common                                                                                   |
|$indent1_result=|checkIfStringAreEqualInArray;|$tresult1,$tresult2,$tresult3,$tresult4,$tresult5,true     |
|check           |checkIfStringAreEqualInArray;|$tresult1,$tresult2,$tresult3,$tresult4,$tresult5,true|true|
*!

!**> Indent Creation 2 and mark as delivered
!**> Indent Creation 2
!define order_type  {0}
!define transporter_id {$transporter_id}
!define vehicle_type_id {$vehicle_id}
!define location_id {$location_id}
!define gate_id {$source_gate_id}
!define vehicle_requirement_date {$vechicle_req_date}
!define loader_available {false}
!define add_to_invoice {false}
!define indent_type {2}
!define destination_location_id {$destination_location_id}
!define sold_to_id {$destination_gate_location_id}
!define unloader_available {false}
!define expected_delivery_at {$expected_date}

!|script|common                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|$data= |getTrim;|{"data":{"order_type":${order_type},"transporter_id":"${transporter_id}","vehicle_type_id":"${vehicle_type_id}","sources":[{"type":1,"location_id":"${location_id}","gate_id":"${gate_id}","vehicle_requirement_date":"${vehicle_requirement_date}","loader_available":${loader_available},"add_to_invoice":${add_to_invoice}}],"destinations":[{"type":1,"location_id":"${destination_location_id}","source_location_id":"${location_id}","source_gate_id":"${gate_id}","sold_to_id":"${sold_to_id}","unloader_available":${unloader_available},"add_to_invoice":${add_to_invoice},"gate_id":"${sold_to_id}"}],"no_of_vehicles": 1}}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Indent.IndentCreationDynamicAPI
*!

!**> validating and Assinging The Truck
!define vechicle_number {tn 09 AT 9013}
!define driver_name  {pay driver}
!define phone_number  {123}
!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Indent.TruckAssignAPI
**!

!**> Create Material invoice 
!define mrp_price {1000}
!define quantity1 {10} 
!define quantity_unit {cases}
!define weight {400}
!define weight_unit {KG}
!define volume {1000}
!define volume_unit {CFT}
!define type {PRIMARY}
!define invoice_amount {20000}
!define invoice_date {$indate}
!define category {}
!define truck_out {$truckoutdate}

!|script|common                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|$data= |getTrim;|{ "data": [ { "indent_no": "$order_id", "delivery_number": "${delivery_number}", "mrp_price": "${mrp_price}", "material_code": "${material_code}", "depot_ref_id": "s$unique", "gate_ref_id": "SG1$unique", "division": "BK", "quantity": "${quantity1}", "quantity_unit": "${quantity_unit}", "weight": "${weight}", "weight_unit": "${weight_unit}", "volume": "${volume}", "volume_unit": "${volume_unit}", "ship_to": "DG1$unique", "sold_to": "DG1$unique", "type": "${type}", "invoice_number": "${invoice_number}", "invoice_amount": "${invoice_amount}", "invoice_date": "${invoice_date}","category": "","truck_out": "${truck_out}" }] }|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.ERPIntegration.MaterialInvoiceDynamicERPAPI
**!

!**> Marking Indent as delivered
!define consignee_id {$destination_location_id}
!define arrived_at {$loadingDate}
!define dispatched_at {$loadingDate}

!|script|common                                                                                                                |
|$data= |getTrim;|{"data":[{"destination_id":"${consignee_id}","reported_at":"${arrived_at}","release_at":"${dispatched_at}"}]}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Indent.MarkAsDeliveredAPI
*!

!**> Enabling Lorry Receipt
!define indent_id {$order_id}
!define tusername {${transporter_email}}
!define tpassword {${transporter_password}}
!|script|common                                                                                                                                                        |
|$data= |getTrim;|{"data":[{"destination_id":"${destination_location_id}","source_location_id":"${location_id}","lr_number":"${lr_number}","document_available":true}]}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.TransporterAPI.LorryReceiptAPI
*!
**!

!**> Validating indent 2 in Ready for billing page with Tax Invoice
!*> Ready for billing page
!|Script  |Common                                          |
|$pdfpath=|getPath;|testAttachment/pdf_$unique.pdf|fullpath|

!|Script               |FileUtil           |
|createFileFromContent;|$pdfpath|test|UTF-8|

!define lr_copy {$pdfpath}
!include -c .FrontPage.Pando.Common.CommonPDFUploadInReadyForBilling
*!

!*> Invoice Page
!define invoice_number {ic2$unique}

!include -c .FrontPage.Pando.Common.CommonInvoiceGeneration
*!
**!

!**> Invoice Filter
!include -c .FrontPage.Pando.Common.ShipperInvoiceFilter

!define search_text {ic2$unique}
!include -c .FrontPage.Pando.Common.CommonInvoiceNumberSearchInShipper
**!

!*> Click Return in Invoice
!|Script                        |Ui                                                                                                                                                                |
|click;                         |//span[contains(text(),'${transporter_name}')]                          |xpath                                                                                    |
|waitForElementToBeDisplayed;   |//div[contains(@class,'scrolling')]                                     |xpath                                                                   |45              |
|click;                         |//button[contains(text(),'Summary')]                                    |xpath                                                                                    |
|click;                         |//button/span[contains(text(),'Return')]                                |xpath                                                                                    |
|sendKeys;                      |//textarea[@placeholder='REMARKS']                                      |xpath                                                                   |Rejected $unique|
|click;                         |//button[text()='RETURN']                                               |xpath                                                                                    |
|waitForElementToBeDisplayed;   |//div[@role='alert']//h3[text()='Success']                              |xpath                                                                   |30              |
|$successMessage=               |getElementAttribute;                                                    |//div[@role='alert']//h3[text()='Success']/following-sibling::span      |xpath |innerText|
|refreshForElementToBeDisplayed;|//span[contains(@class,'status') and normalize-space(text())='Returned']|findBy                                                                  |2     |5        |
|check                          |isElementPresent;                                                       |//span[contains(@class,'status') and normalize-space(text())='Returned']|xpath |true     |
|$tresult1=                     |isElementPresent;                                                       |//span[contains(@class,'status') and normalize-space(text())='Returned']|xpath           |

!|Script   |common                                                       |
|check     |checkIfStringAreEqual;|$successMessage|Invoice Returned!|true|
|$tresult2=|checkIfStringAreEqual;|$successMessage|Invoice Returned!     |
**!

!*> update invoice number,invoice date and GSTIN and Click Resubmit in Transporter Invoice after returned
!include -c .FrontPage.Pando.Common.CommonTransporterInvoiceFilter

!include -c .FrontPage.Pando.Common.CommonInvoiceNumberSearchInShipper

!define new_invoice_number {newinv$unique}
!define new_gstin {gst2$unique}

!|Script                     |Ui                                                                                                                                                               |
|click;                      |//span[contains(@class,'status') and normalize-space(text())='Returned']|xpath                                                                                   |
|wait;                       |5                                                                                                                                                                |
|click;                      |//button[contains(text(),'Summary')]                                    |xpath                                                                                   |
|clearAndSend;               |//input[@placeholder='Enter Invoice Number']                            |xpath                                                             |${new_invoice_number}|
|click;                      |//input[@placeholder='Enter Invoice date']                              |xpath                                                                                   |
|clickJS;                    |//button[@date='$newinvdate']                                           |xpath                                                                                   |
|wait;                       |2                                                                                                                                                                |
|clearAndSend;               |//input[@placeholder='Enter GSTIN Number']                              |xpath                                                             |${new_gstin}         |
|click;                      |//button[contains(text(),'Re-Submit')]                                  |xpath                                                                                   |
|click;                      |//button/span[normalize-space(text())='YES']                            |xpath                                                                                   |
|waitForElementToBeDisplayed;|//div[@role='alert']//h3[text()='Success']                              |xpath                                                             |30                   |
|$successMessage=            |getElementAttribute;                                                    |//div[@role='alert']//h3[text()='Success']/following-sibling::span|xpath   |innerText   |

!define search_text {newinv$unique}
!include -c .FrontPage.Pando.Common.CommonInvoiceNumberSearchInTransporter

!|Script   |Ui                                                                                                       |
|check     |isElementPresent;|//span[contains(@class,'status') and normalize-space(text())='Re-submitted']|xpath|true|
|$tresult3=|isElementPresent;|//span[contains(@class,'status') and normalize-space(text())='Re-submitted']|xpath     |
**!

!**> Invoice Filter in shipper
!|Script       |Ui                |
|navigateToUrl;|${surl}/v2/invoice|

!define search_text {newinv$unique}
!include -c .FrontPage.Pando.Common.CommonInvoiceNumberSearchInShipper
**!

!*> Click Checked in Invoice
!|Script                        |Ui                                                                                                                                                                                  |
|click;                         |//span[contains(text(),'${transporter_name}')]                         |xpath                                                                                                       |
|waitForElementToBeDisplayed;   |//div[contains(@class,'scrolling')]                                    |xpath                                                                                  |45                  |
|click;                         |//button[contains(text(),'Summary')]                                   |xpath                                                                                                       |
|wait;                          |2                                                                                                                                                                                   |
|$headerNo=                     |getHeaderColumnNumber;                                                 |//div[contains(@class,'row label')]//div[contains(@class,'seclabel')]                  |xpath|Invoice Number|
|$invoice_number=               |getText;                                                               |(//div[contains(@class,'row label')]//div[contains(@class,'sectext')])[$headerNo]      |xpath               |
|$headerNo=                     |getHeaderColumnNumber;                                                 |//div[contains(@class,'row label')]//div[contains(@class,'seclabel')]                  |xpath|Invoice date  |
|$invoice_date=                 |getText;                                                               |(//div[contains(@class,'row label')]//div[contains(@class,'sectext')])[$headerNo]      |xpath               |
|$headerNo=                     |getHeaderColumnNumber;                                                 |//div[contains(@class,'row label')]//div[contains(@class,'seclabel')]//span            |xpath|GSTIN         |
|$gstin=                        |getText;                                                               |(//div[contains(@class,'row label')]//div[contains(@class,'sectext')]//span)[$headerNo]|xpath               |
|click;                         |//button/span[contains(text(),'Checked')]                              |xpath                                                                                                       |
|click;                         |//button/span[normalize-space(text())='YES']                           |xpath                                                                                                       |
|waitForElementToBeDisplayed;   |//div[@role='alert']//h3[text()='Success']                             |xpath                                                                                  |30                  |
|$successMessage=               |getElementAttribute;                                                   |//div[@role='alert']//h3[text()='Success']/following-sibling::span                     |xpath|innerText     |
|waitForElementToDisappear;     |//div[@role='alert']//h3[text()='Success']                             |xpath                                                                                  |10                  |
|refreshForElementToBeDisplayed;|//span[contains(@class,'status') and normalize-space(text())='Checked']|findBy                                                                                 |2    |5             |
|check                          |isElementPresent;                                                      |//span[contains(@class,'status') and normalize-space(text())='Checked']                |xpath|true          |
|$tresult4=                     |isElementPresent;                                                      |//span[contains(@class,'status') and normalize-space(text())='Checked']                |xpath               |

!|Script   |common                                                           |
|check     |checkIfStringAreEqual;|$successMessage|Invoice Checked!     |true|
|$tresult5=|checkIfStringAreEqual;|$successMessage|Invoice Checked!          |
|check     |checkIfStringAreEqual;|$invoice_number|${new_invoice_number}|true|
|$tresult6=|checkIfStringAreEqual;|$invoice_number|${new_invoice_number}     |
|check     |checkIfStringAreEqual;|$gstin         |${new_gstin}         |true|
|$tresult7=|checkIfStringAreEqual;|$gstin         |${new_gstin}              |
|check     |checkIfStringAreEqual;|$invoice_date  |$newinvdate2         |true|
|$tresult8=|checkIfStringAreEqual;|$invoice_date  |$newinvdate2              |
**!

!*> Click Approve in Invoice after checking
!|Script                        |Ui                                                                                                                                                               |
|refresh;                                                                                                                                                                                         |
|click;                         |//span[contains(text(),'${transporter_name}')]                          |xpath                                                                                   |
|waitForElementToBeDisplayed;   |//div[contains(@class,'scrolling')]                                     |xpath                                                                   |45             |
|click;                         |//button[contains(text(),'Summary')]                                    |xpath                                                                                   |
|click;                         |//button/span[contains(text(),'Approve')]                               |xpath                                                                                   |
|click;                         |//button/span[normalize-space(text())='YES']                            |xpath                                                                                   |
|waitForElementToBeDisplayed;   |//div[@role='alert']//h3[text()='Success']                              |xpath                                                                   |30             |
|$successMessage=               |getElementAttribute;                                                    |//div[@role='alert']//h3[text()='Success']/following-sibling::span      |xpath|innerText|
|refreshForElementToBeDisplayed;|//span[contains(@class,'status') and normalize-space(text())='Approved']|findBy                                                                  |2    |5        |
|check                          |isElementPresent;                                                       |//span[contains(@class,'status') and normalize-space(text())='Approved']|xpath|true     |
|$tresult9=                     |isElementPresent;                                                       |//span[contains(@class,'status') and normalize-space(text())='Approved']|xpath          |

!|Script    |common                                                       |
|check      |checkIfStringAreEqual;|$successMessage|Invoice Approved!|true|
|$tresult10=|checkIfStringAreEqual;|$successMessage|Invoice Approved!     |
**!

!**> Validating invoices in transporter
!include -c .FrontPage.Pando.Common.CommonTransporterInvoiceFilter

!define search_text {newinv$unique}
!include -c .FrontPage.Pando.Common.CommonInvoiceNumberSearchInTransporter

!|Script         |Ui                                                                                                                                                                             |
|check           |isElementPresent;                                                       |//span[contains(@class,'status') and normalize-space(text())='Approved']         |xpath|true          |
|$tresult11=     |isElementPresent;                                                       |//span[contains(@class,'status') and normalize-space(text())='Approved']         |xpath               |
|click;          |//span[contains(@class,'status') and normalize-space(text())='Approved']|xpath                                                                                                 |
|wait;           |5                                                                                                                                                                              |
|click;          |//button[contains(text(),'Summary')]                                    |xpath                                                                                                 |
|wait;           |2                                                                                                                                                                              |
|$headerNo=      |getHeaderColumnNumber;                                                  |//div[@class='row labelgrid']//div[contains(@class,'primarylabel')]              |xpath|Invoice Number|
|$invoice_number=|getText;                                                                |(//div[contains(@class,'row label')]//div[contains(@class,'sectext')])[$headerNo]|xpath               |
|$headerNo=      |getHeaderColumnNumber;                                                  |//div[@class='row labelgrid']//div[contains(@class,'primarylabel')]              |xpath|Invoice date  |
|$invoice_date=  |getText;                                                                |(//div[contains(@class,'row label')]//div[contains(@class,'sectext')])[$headerNo]|xpath               |
|$headerNo=      |getHeaderColumnNumber;                                                  |//div[@class='row labelgrid']//div[contains(@class,'primarylabel')]              |xpath|GSTIN         |
|$gstin=         |getText;                                                                |(//div[contains(@class,'row label')]//div[contains(@class,'sectext')])[$headerNo]|xpath               |

!|Script    |common                                                           |
|check      |checkIfStringAreEqual;|$invoice_number|${new_invoice_number}|true|
|$tresult12=|checkIfStringAreEqual;|$invoice_number|${new_invoice_number}     |
|check      |checkIfStringAreEqual;|$gstin         |${new_gstin}         |true|
|$tresult13=|checkIfStringAreEqual;|$gstin         |${new_gstin}              |
|check      |checkIfStringAreEqual;|$invoice_date  |$newinvdate3         |true|
|$tresult14=|checkIfStringAreEqual;|$invoice_date  |$newinvdate3              |
**!

!**> Validating result
!|Script         |Common                                                                                                                                                                                  |
|$indent2_result=|checkIfStringAreEqualInArray;|$tresult1,$tresult2,$tresult3,$tresult4,$tresult5,$tresult6,$tresult7,$tresult8,$tresult9,$tresult10,$tresult11,$tresult12,$tresult13,$tresult14,true     |
|check           |checkIfStringAreEqualInArray;|$tresult1,$tresult2,$tresult3,$tresult4,$tresult5,$tresult6,$tresult7,$tresult8,$tresult9,$tresult10,$tresult11,$tresult12,$tresult13,$tresult14,true|true|
*!

!**> Validating final result
!|Script  |Common                                                                 |
|$tresult=|checkIfStringAreEqualInArray;|$indent1_result,$indent2_result,true     |
|check    |checkIfStringAreEqualInArray;|$indent1_result,$indent2_result,true|true|
*!
