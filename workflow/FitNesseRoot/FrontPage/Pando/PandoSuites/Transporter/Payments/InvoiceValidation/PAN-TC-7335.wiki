---
Help: Verify Bill to party details and invoice preview when primary and secondary indents are combined in invoice
Suites: srf
Test
---
!** Prerequisite
Transporter in MDM

Name: SRF logistics
Ref id: SRFTRANS
email id: pandosrfauto+2@outlook.com
**!

!**> Unique values assignment
!|Script            |DateUtil                               |
|$unique=           |getCurrentDateTimeStamp;|yMMddHHmmss   |
|$truckoutdate=     |dateCalculation;        |yyyy/MM/dd |-1|
|$rdate=            |dateCalculation;        |yyyy/MM/dd |0 |
|$contractDate=     |dateCalculation;        |dd-MMM-yyyy|2 |
|$monthAndYear=     |dateCalculation;        |MMMM yyyy  |0 |
|$todayDate=        |dateCalculation;        |d          |0 |
|$ordinalDateSuffix=|getOrdinalDateSuffix;   |$todayDate    |
|$indate=           |getCurrentDateTimeStamp;|yyyy/MM/dd    |
|$indate2=          |dateCalculation;        |yyyy-MM-dd |0 |
|$vechicle_req_date=|dateCalculation;        |yyyy/MM/dd |-6|

|Script             |Common                                              |
|$vno_1=            |getRandomNumber;    |20                |76          |
|$vno_2=            |getRandomString;    |2                 |ALPHAUPPER  |
|$vno_3=            |getRandomNumber;    |1000              |9999        |
|$truckoutdate=     |stringConcatenation;|$truckoutdate     |!- $timer -!|
|$vechicle_req_date=|stringConcatenation;|$vechicle_req_date|!- $timer -!|
|$rdate=            |stringConcatenation;|$rdate            |!- $timer -!|
|$num=              |getRandomNumber;    |100000            |999999      |
|$year=             |getSubString;       |$unique           |0     |4    |

!|Script            |DateUtil                                  |
|$truckoutdate=     |utcConversion;         |$truckoutdate     |
|$rdate=            |utcConversion;         |$rdate            |
|$vechicle_req_date=|utcConversion;         |$vechicle_req_date|
|$loadingDate=      |getCurrentDateTimeStamp|iso               |

!define truck_no {TN $vno_1 $vno_2 $vno_3}
**!

!**> Data Creation for Primary movement
!**> Source Depot Creation
!define depot_name {src$unique}
!define depot_state {Tamil Nadu}
!define depot_city {s$unique}
!define depot_region {South}
!define depot_short_code {s$num}
!define depot_reference_id {s$unique}
!define depot_address {No 22,Main Street}
!define depot_pincode {600344}
!define depot_gstn_no {6667645465}
!define depot_delivery_type {1}
!define depot_phone {123}
!define gname {Gate 1}
!define grefid {SG1$unique}
!define g_user_email {pandoindent+1$unique@gmail.com}

!include -c .FrontPage.Pando.Common.CommonDepoCreationWithGate

!|script         |common           |
|$location_id=   |getTrim;|$depot  |
|$source_gate_id=|getTrim;|$gate_id|
*!

!**> Destination Depot Creation
!define depot_name {dest$unique}
!define depot_state {Haryana}
!define depot_city {d$unique}
!define depot_region {South}
!define depot_short_code {d$num}
!define depot_reference_id {dr$unique}
!define depot_address {No 15,GST Street}
!define depot_pincode {455656}
!define depot_gstn_no {123}
!define depot_delivery_type {1}
!define depot_phone {123}
!define gname {Gate 1}
!define grefid {DG1$unique}
!define g_user_email {pandoindent+2$unique@gmail.com}

!include -c .FrontPage.Pando.Common.CommonDepoCreationWithGate

!|script                       |common           |
|$destination_location_id=     |getTrim;|$depot  |
|$destination_gate_location_id=|getTrim;|$gate_id|
*!

!**> Material Creation
!define material_name {m$unique}
!define material_code {mc$unique}

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.DataManager.MaterialCreationAPI
**!

!**> Vehicle Creation
!define vehicle_name {v$unique MRT}
!define cft {965}
!define kg {1000}
!define vehicle_type {FTL}

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.DataManager.VehicleCreationAPI
*!

!**> Transporter Creation for Indent
!define transporter_name {SRF logistics}
!define transporter_ref_id {SRFTRANS}
!define transporter_id {5fc89238d2743f0055dd5fc0}
*!

!**> Retrieving Password for the Created Transporter 
!define manager_email {pandosrfauto+2@outlook.com}
!include -c .FrontPage.Pando.Common.CommonTransporterPassword
*!

!**> Rate Matrix upload
!define row {Type*,Source*,Destination*,Vehicle Type*,Distance,Transporter Reference ID*,Transporter Name,Transit Days*,Freight Rate*,Freight Unit*,Valid From*,Valid To*,Minimum Rate,Multiplying Factor,Detention Group,Product Category,Fixed Rate,ODA Rate,Oda Unit,Minimum ODA,Point Charges,Is Dedicated,Truck Count,Slab Kms,Min Kms,Additional Charge Percentage,Hilly Region Addition Percentage,Is Round Trip Eligible,Return Freight Rate,BDR Charge,BDR Label,Exclude,Trip Count}
!define column {City,s$unique,d$unique,${vehicle_name},100,${transporter_ref_id},${transporter_name},1,5000,per_trip,01-Jan-2019,$contractDate,100,1,P}

!include -c .FrontPage.Pando.Common.RateMatrix
*!
**!

!**> Indent Creation - Primary and mark as delivered
!**> Indent Creation
!define order_type  {0}
!define vehicle_type_id {$vehicle_id}
!define location_id {$location_id}
!define gate_id {$source_gate_id}
!define vehicle_requirement_date {$vechicle_req_date}
!define loader_available {false}
!define add_to_invoice {false}
!define indent_type {2}
!define destination_location_id {$destination_location_id}
!define sold_to_id {$destination_gate_location_id}
!define unloader_available {false}
!define expected_delivery_at {$expected_date}

!|script|common                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|$data= |getTrim;|{"data":{"order_type":${order_type},"transporter_id":"${transporter_id}","vehicle_type_id":"${vehicle_type_id}","sources":[{"type":1,"location_id":"${location_id}","gate_id":"${gate_id}","vehicle_requirement_date":"${vehicle_requirement_date}","loader_available":${loader_available},"add_to_invoice":${add_to_invoice}}],"destinations":[{"type":1,"location_id":"${destination_location_id}","source_location_id":"${location_id}","source_gate_id":"${gate_id}","sold_to_id":"${sold_to_id}","unloader_available":${unloader_available},"add_to_invoice":${add_to_invoice},"gate_id":"${sold_to_id}"}],"no_of_vehicles": 1}}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Indent.IndentCreationDynamicAPI

!|script     |common            |
|$order_id_1=|getTrim;|$order_id|
*!

!**> validating and Assinging The Truck
!define vechicle_number {tn 09 AT 9013}
!define driver_name  {pay driver}
!define phone_number  {123}
!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Indent.TruckAssignAPI
**!

!**> Create Material invoice 
!define mrp_price {1000}
!define quantity1 {10} 
!define quantity_unit {cases}
!define weight {400}
!define weight_unit {KG}
!define volume {1000}
!define volume_unit {CFT}
!define type {PRIMARY}
!define invoice_amount {20000}
!define invoice_date {$indate}
!define category {}
!define truck_out {$truckoutdate}

!|script|common                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|$data= |getTrim;|{ "data": [ { "indent_no": "$order_id", "delivery_number": "${delivery_number}", "mrp_price": "${mrp_price}", "material_code": "${material_code}", "depot_ref_id": "s$unique", "gate_ref_id": "SG1$unique", "division": "BK", "quantity": "${quantity1}", "quantity_unit": "${quantity_unit}", "weight": "${weight}", "weight_unit": "${weight_unit}", "volume": "${volume}", "volume_unit": "${volume_unit}", "ship_to": "DG1$unique", "sold_to": "DG1$unique", "type": "${type}", "invoice_number": "${invoice_number}", "invoice_amount": "${invoice_amount}", "invoice_date": "${invoice_date}","category": "","truck_out": "${truck_out}" }] }|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.ERPIntegration.MaterialInvoiceDynamicERPAPI
**!

!**> Marking Indent as delivered
!define consignee_id {$destination_location_id}
!define arrived_at {$loadingDate}
!define dispatched_at {$loadingDate}

!|script|common                                                                                                                |
|$data= |getTrim;|{"data":[{"destination_id":"${consignee_id}","reported_at":"${arrived_at}","release_at":"${dispatched_at}"}]}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Indent.MarkAsDeliveredAPI
*!
**!

!**> Data creation for Secondary movement
!***> Consignee Creation
!define consignee_name {c$unique}
!define consignee_ref_id {cr$unique}
!define address {A Nagar}
!define city {city$unique}
!define state {Andra Pradesh}
!define pincode {520122}
!define manager_name {Manager Automation1}
!define manager_mobile {123}
!define manager_email {pandoconsignee+$unique@gmail.com}
!define region {South}
!define site {2}
!define group {$cGroup}

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.DataManager.ConsigneeCreationAPI

!| Script            |Common                      |
|$consignee_id_1=    |getTrim;|$consignee_id      |
|$consignee_id_ref_1=|getTrim;|${consignee_ref_id}|

!| Script         |json                                  |
|$consignee1_name=|getValueFromJSON;|$consignee|data.name|
*!

!***> Uploading Rate Matrix
!define row {Type*,Source*,Destination*,Vehicle Type*,Distance,Transporter Reference ID*,Transporter Name,Transit Days*,Freight Rate*,Freight Unit*,Valid From*,Valid To*,Minimum Rate,Multiplying Factor,Detention Group,Product Category,Fixed Rate,ODA Rate,Oda Unit,Minimum ODA,Point Charges,Is Dedicated,Truck Count,Slab Kms,Min Kms,Additional Charge Percentage,Hilly Region Addition Percentage,Is Round Trip Eligible,Return Freight Rate,BDR Charge,BDR Label,Exclude,Trip Count}
!define column {City,s$unique,city$unique,${vehicle_name},100,${transporter_ref_id},${transporter_name},1,6000,per_trip,01-Jan-$year,31-Dec-2030,100,1,}

!include -c .FrontPage.Pando.Common.RateMatrix
*!
**!

!**> Indent Creation - Secondary and Deliver indent
!**> Indent Creation
!define order_type  {0}
!define vehicle_type_id {$vehicle_id}
!define location_id {$location_id}
!define gate_id {$source_gate_id}
!define vehicle_requirement_date {$loadingDate}
!define loader_available {false}
!define add_to_invoice {false}
!define indent_type {2}
!define destination_location_id {$consignee_id}
!define sold_to_id {$consignee_id}
!define unloader_available {false}
!define expected_delivery_at {$expected_date}

!include -c  .FrontPage.Pando.PandoSuites.PandoAPI.Indent.IndentCreationAPI

!|script     |common            |
|$order_id_2=|getTrim;|$order_id|
*!

!**> Deliver Indent
!***> Adding Truck details
!define vechicle_number {${truck_no}}
!define driver_name {d$unique}
!define phone_number {123}

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Indent.TruckAssignAPI
*!

!**> Update LR for Consignee
!define consignee_id {$consignee_id_1}
!define lr_number {l1$unique}

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Indent.LRUpdateAPI
**!

!**> Material upload for all consingee
!define mrp_price {100}
!define quantity1 {100} 
!define quantity_unit {case}
!define weight {480}
!define weight_unit {KG}
!define volume {450}
!define volume_unit {CFT}
!define type {SECONDARY}
!define invoice_amount {10000}
!define invoice_date {$indate}
!define category {}
!define truck_out {$truckoutdate}

!|script|common                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|$data= |getTrim;|{"data":[{"indent_no":"$order_id","delivery_number":"D1$unique","mrp_price":"${mrp_price}","material_code":"mc$unique","depot_ref_id":"s$unique","gate_ref_id":"SG1$unique","division":"BK","quantity":"${quantity1}","quantity_unit":"${quantity_unit}","weight":"${weight}","weight_unit":"${weight_unit}","volume":"${volume}","volume_unit":"${volume_unit}","ship_to":"$consignee_id_ref_1","sold_to":"$consignee_id_ref_1","type":"${type}","invoice_number":"INV-$unique","invoice_amount":"${invoice_amount}","invoice_date":"$indate","category":"${category}","truck_out":"$truckoutdate","cgst_rate":"0","cgst_amount":"0","sgst_rate":"0","sgst_amount":"0","igst_rate":"0","igst_amount":"0","hsn_code":"1806","material_taxable_amount":"0"}]}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.ERPIntegration.MaterialInvoiceDynamicERPAPI
**!

!**> ERP Upload for Consignee
!|script|common                                                                                                                                                                                                                                                                                                                            |
|$data= |getTrim;|{"data":[{"indent_number":"$order_id","ship_to":"$consignee_id_ref_1","sold_to":"$consignee_id_ref_1","material_invoice_number":"INV-$unique","material_code":"mc$unique","no_of_shortage":"0","no_of_leakage":"0","mrp":"100","no_of_excess":"0","no_of_damage":"0","no_of_carton_damage":"0","release_date":"$rdate"}]}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.ERPIntegration.EpodDynamicERPAPI
**!
**!
**!


!** Transporter Login
!define transporter_email {pandosrfauto+2@outlook.com}
!define transporter_password {$password}
!include -c .FrontPage.Pando.Common.TransporterLogin
*!

!*> Ready for billing page
!define depot_name {src$unique}

!**> LR Upload
!|Script   |Common                                           |
|$pdfpath1=|getPath;|testAttachment/pdf1_$unique.pdf|fullpath|

!|Script               |FileUtil            |
|createFileFromContent;|$pdfpath1|test|UTF-8|

!|Script       |Ui                                     |
|navigateToUrl;|${turl}/v2/payments?depot=${depot_name}|

!define search_text {$order_id_1}
!include .FrontPage.Pando.PandoSuites.WalletV2.ListingAndFilter.CommonWalletIndentSearch

!|Script  |Ui                                                     |
|click;   |//*[normalize-space(text())='Update']  |xpath          |
|sendKeys;|(//input[@class='el-upload__input'])[1]|xpath|$pdfpath1|
|wait;    |3                                                      |
|refresh;                                                         |

!define search_text {$order_id_2}
!include .FrontPage.Pando.PandoSuites.WalletV2.ListingAndFilter.CommonWalletIndentSearch

!|Script  |Ui                                                     |
|click;   |//*[normalize-space(text())='Update']  |xpath          |
|sendKeys;|(//input[@class='el-upload__input'])[1]|xpath|$pdfpath1|
|wait;    |5                                                      |
|refresh;                                                         |

!|Script|Ui                             |
|click; |//span[text()='Search']  |xpath|
|click; |//button[text()='Clear'] |xpath|
|wait;  |3                              |
|click; |//button[text()='Search']|xpath|
**!
*!

!**> Verify primary indents and secondary indents are combined
!|Script|Ui                                            |
|click; |(//span[@class='el-checkbox__inner'])[1]|xpath|
|click; |(//span[@class='el-checkbox__inner'])[3]|xpath|
|wait;  |3                                             |
|click; |//button[text()='Create Invoice']       |xpath|
*!

!*> Verify bill to party in ready for billing - before generating invoice
!define invoice_number {inv$num}
!define gstin_number {$unique} 

!|Script                     |Ui                                                                                                                                  |
|waitForElementToBeDisplayed;|//div[contains(@class,'table__body')]|xpath                                                                              |20        |
|check                       |isElementPresent;                    |//span[contains(text(),'$order_id_1')]                                             |xpath|true|
|check                       |isElementPresent;                    |//span[contains(text(),'$order_id_2')]                                             |xpath|true|
|click;                      |//button[contains(text(),'Summary')] |xpath                                                                                         |
|$billtoparty_value=         |getValue;                            |//input[@placeholder='Select Bill to Party']                                       |xpath     |
|$place_of_supply=           |getText;                             |//div[text()='PLACE OF SUPPLY']/../following-sibling::div//span[last()]            |xpath     |
|$gst_method=                |getText;                             |//div[text()='GST Method']/../following-sibling::div//div[contains(@class,'text')] |xpath     |
|$igst_value=                |getText;                             |//div[text()='IGST (12%)']/../following-sibling::div//div[contains(@class,'value')]|xpath     |
|check                       |isElementNotDisplayed;               |//div[starts-with(text(),'SGST')]                                                  |xpath|true|
|$tresult1=                  |isElementNotDisplayed;               |//div[starts-with(text(),'SGST')]                                                  |xpath     |

!|script   |common                                                     |
|check     |checkIfStringAreEqual;|$place_of_supply  |Tamil Nadu  |true|
|check     |checkIfStringAreEqual;|$gst_method       |FORWARD     |true|
|check     |checkIfStringAreEqual;|$igst_value       |1,320       |true|
|check     |checkIfStringAreEqual;|$billtoparty_value|Source Depot|true|
|$tresult2=|checkIfStringAreEqual;|$billtoparty_value|Source Depot     |

!|Script     |ui                                                                                                                                                                   |
|click;      |//div[text()='Service provider state']/../following-sibling::div//input|xpath                                                                                        |
|clickJS;    |//li//span[text()='Tamil Nadu']                                        |xpath                                                                                        |
|wait;       |3                                                                                                                                                                    |
|check       |isElementDisplayed;                                                    |//div[starts-with(text(),'CGST (6%)')]                                            |xpath|true|
|check       |isElementDisplayed;                                                    |//div[starts-with(text(),'SGST (6%)')]                                            |xpath|true|
|$cgst_value=|getText;                                                               |//div[text()='CGST (6%)']/../following-sibling::div//div[contains(@class,'value')]|xpath     |
|$sgst_value=|getText;                                                               |//div[text()='SGST (6%)']/../following-sibling::div//div[contains(@class,'value')]|xpath     |
|refresh;                                                                                                                                                                          |

!|script|common                                     |
|check  |checkIfStringAreEqual;|$cgst_value|660|true|
|check  |checkIfStringAreEqual;|$sgst_value|660|true|
**!

!**> Verify default Bill to party
!define gstin {gstin$unique}
!define service_provider_state {Haryana}

!|Script                     |ui                                                                                                                                                                    |
|waitForElementToBeDisplayed;|//div[contains(@class,'table__body')]                      |xpath                                                                                   |20               |
|click;                      |//button[contains(text(),'Summary')]                       |xpath                                                                                                     |
|wait;                       |3                                                                                                                                                                     |
|$value1=                    |getText;                                                   |//div[text()='TOTAL INVOICE VALUE']/parent::div/following::div                          |xpath            |
|sendKeys;                   |//input[@placeholder='Enter Invoice Number']               |xpath                                                                                   |${invoice_number}|
|click;                      |(//input[@placeholder='Select'])[4]                        |xpath                                                                                                     |
|clickJS;                    |//li//span[text()='${service_provider_state}']             |xpath                                                                                                     |
|sendKeys;                   |//input[@placeholder='Enter GSTIN Number']                 |xpath                                                                                   |gst$unique       |
|sendKeys;                   |//textarea                                                 |xpath                                                                                   |remarks $unique  |
|wait;                       |10                                                                                                                                                                    |
|$address_billtoparty=       |getText;                                                   |//div[text()='Bill to Party']/../parent::div/following::div[contains(@class,'bgfooter')]|xpath            |
|click;                      |//div[text()='Bill to Party']/../parent::div/following::div|xpath                                                                                                     |
|$billtoparty_name=          |getValue;                                                  |//div[text()='Name of Entity']/../following-sibling::div//input                         |xpath            |
|$billtoparty_address=       |getValue;                                                  |//div[text()='Address']/../following-sibling::div//input                                |xpath            |
|$billtoparty_city=          |getValue;                                                  |//div[text()='City']/../following-sibling::div//input                                   |xpath            |
|$billtoparty_state=         |getValue;                                                  |//div[text()='State']/../following-sibling::div//input                                  |xpath            |
|$billtoparty_gstin=         |getValue;                                                  |//div[text()='GSTIN']/../following-sibling::div//input                                  |xpath            |
|click;                      |//button[contains(text(),'Generate Invoice')]              |xpath                                                                                                     |
|click;                      |//button/span[normalize-space(text())='YES']               |xpath                                                                                                     |
|waitUntilElementDisplayed;  |//div[@role='alert']//h3[text()='Success']                 |xpath                                                                                   |30               |
|$successMessage=            |getElementAttribute;                                       |//div[@role='alert']//h3[text()='Success']/following-sibling::span                      |xpath |innerText |

!|script    |common                                                                                           |
|check      |checkIfStringAreEqual;|$billtoparty_value                              |Source Depot        |true|
|$tresult3= |checkIfStringAreEqual;|$billtoparty_value                              |Source Depot             |
|check      |checkIfStringAreEqual;|$value1                                         |12,320              |true|
|$tresult4= |checkIfStringAreEqual;|$value1                                         |12,320                   |
|check      |checkIfStringExistsIn;|SRF LTD.                                        |$address_billtoparty|true|
|check      |checkIfStringExistsIn;|NO 22,MAIN STREET, S$unique, TAMIL NADU - 600344|$address_billtoparty|true|
|check      |checkIfStringExistsIn;|GSTIN: 6667645465                               |$address_billtoparty|true|
|$tresult5= |checkIfStringExistsIn;|NO 22,MAIN STREET, S$unique, TAMIL NADU - 600344|$address_billtoparty     |
|$tresult6= |checkIfStringAreEqual;|$billtoparty_name                               |SRF Ltd.                 |
|$tresult7= |checkIfStringAreEqual;|$billtoparty_address                            |No 22,Main Street        |
|$tresult8= |checkIfStringAreEqual;|$billtoparty_city                               |S$unique                 |
|$tresult9= |checkIfStringAreEqual;|$billtoparty_state                              |Tamil Nadu               |
|$tresult10=|checkIfStringAreEqual;|$billtoparty_gstin                              |6667645465               |
**!

!**> Verify bill to party in invoice after generation in Transporter

!include -c .FrontPage.Pando.Common.CommonTransporterInvoiceFilter

!|Script                     |ui                                                                                                                                                                                      |
|waitForElementToBeDisplayed;|//div[contains(@class,'card-row')]                                                  |xpath                                                                                   |20        |
|check                       |isElementPresent;                                                                   |//span[contains(text(),'${invoice_number}')]                                            |xpath|true|
|click;                      |//span[contains(text(),'${invoice_number}')]                                        |xpath                                                                                              |
|waitForElementToBeDisplayed;|//div[contains(@class,'table__body')]                                               |xpath                                                                                   |20        |
|click;                      |//button[contains(text(),'Summary')]                                                |xpath                                                                                              |
|waitForElementToBeDisplayed;|//div[text()='PLACE OF SUPPLY']/../following-sibling::div//span[text()='Tamil Nadu']|xpath                                                                                   |15        |
|$billtoparty_value=         |getText;                                                                            |//div[contains(text(),'Bill to Party')]/..//following-sibling::div//span                |xpath     |
|$address_billtoparty=       |getText;                                                                            |//div[text()='Bill to Party']/../parent::div/following::div[contains(@class,'bgfooter')]|xpath     |
|click;                      |//div[text()='Bill to Party']/../parent::div/following::div                         |xpath                                                                                              |
|$billtoparty_name=          |getValue;                                                                           |//div[text()='Name of Entity']/../following-sibling::div//input                         |xpath     |
|$billtoparty_address=       |getValue;                                                                           |//div[text()='Address']/../following-sibling::div//input                                |xpath     |
|$billtoparty_city=          |getValue;                                                                           |//div[text()='City']/../following-sibling::div//input                                   |xpath     |
|$billtoparty_state=         |getValue;                                                                           |//div[text()='State']/../following-sibling::div//input                                  |xpath     |
|$billtoparty_gstin=         |getValue;                                                                           |//div[text()='GSTIN']/../following-sibling::div//input                                  |xpath     |

!|script    |common                                                                                           |
|check      |checkIfStringAreEqual;|$billtoparty_value                              |Source Depot        |true|
|$tresult11=|checkIfStringAreEqual;|$billtoparty_value                              |Source Depot             |
|check      |checkIfStringAreEqual;|$value1                                         |12,320              |true|
|$tresult12=|checkIfStringAreEqual;|$value1                                         |12,320                   |
|check      |checkIfStringExistsIn;|SRF LTD.                                        |$address_billtoparty|true|
|check      |checkIfStringExistsIn;|NO 22,MAIN STREET, S$unique, TAMIL NADU - 600344|$address_billtoparty|true|
|check      |checkIfStringExistsIn;|GSTIN: 6667645465                               |$address_billtoparty|true|
|$tresult13=|checkIfStringExistsIn;|NO 22,MAIN STREET, S$unique, TAMIL NADU - 600344|$address_billtoparty     |
|$tresult14=|checkIfStringAreEqual;|$billtoparty_name                               |SRF Ltd.                 |
|$tresult15=|checkIfStringAreEqual;|$billtoparty_address                            |No 22,Main Street        |
|$tresult16=|checkIfStringAreEqual;|$billtoparty_city                               |S$unique                 |
|$tresult17=|checkIfStringAreEqual;|$billtoparty_state                              |Tamil Nadu               |
|$tresult18=|checkIfStringAreEqual;|$billtoparty_gstin                              |6667645465               |

!**> Validating result
!|script              |common                                                                                                                                                                                                                              |
|check                |checkIfStringAreEqualInArray;|$tresult1,$tresult2,$tresult3,$tresult4,$tresult5,$tresult6,$tresult7,$tresult8,$tresult9,$tresult10,$tresult11,$tresult12,$tresult13,$tresult14,$tresult15,$tresult16,$tresult17,$tresult18,true|true|
|$transporter_tresult=|checkIfStringAreEqualInArray;|$tresult1,$tresult2,$tresult3,$tresult4,$tresult5,$tresult6,$tresult7,$tresult8,$tresult9,$tresult10,$tresult11,$tresult12,$tresult13,$tresult14,$tresult15,$tresult16,$tresult17,$tresult18,true     |
*!
**!

!**> Verify bill to party in invoice after generation in Shipper
!|script               |common                    |
|$downloadPath=        |getPath;|download|fullpath|
|cleanFilesInDirectory;|$downloadPath             |

!include -c .FrontPage.Pando.Common.ShipperInvoiceFilter

!|Script                     |ui                                                                                                                                                               |
|click;                      |//span[contains(text(),'${invoice_number}')]|xpath                                                                                                               |
|waitForElementToBeDisplayed;|//div[contains(@class,'table__body')]       |xpath                                                                                  |20                          |
|click;                      |//button[contains(text(),'Summary')]        |xpath                                                                                                               |
|wait;                       |3                                                                                                                                                                |
|$headerNo=                  |getHeaderColumnNumber;                      |//div[contains(@class,'row label')]//div[contains(@class,'seclabel')]                  |xpath|Invoice Number        |
|$invoice_number=            |getText;                                    |(//div[contains(@class,'row label')]//div[contains(@class,'sectext')])[$headerNo]      |xpath                       |
|$headerNo=                  |getHeaderColumnNumber;                      |//div[contains(@class,'row label')]//div[contains(@class,'seclabel')]                  |xpath|Invoice date          |
|$invoice_date=              |getText;                                    |(//div[contains(@class,'row label')]//div[contains(@class,'sectext')])[$headerNo]      |xpath                       |
|$headerNo=                  |getHeaderColumnNumber;                      |//div[contains(@class,'row label')]//div[contains(@class,'seclabel')]                  |xpath|PLACE OF SUPPLY       |
|$place_of_supply=           |getText;                                    |(//div[contains(@class,'row label')]//div[contains(@class,'sectext')])[$headerNo]      |xpath                       |
|$headerNo=                  |getHeaderColumnNumber;                      |//div[contains(@class,'row label')]//div[contains(@class,'seclabel')]                  |xpath|Bill to Party         |
|$billtoparty_value=         |getText;                                    |(//div[contains(@class,'row label')]//div[contains(@class,'sectext')])[$headerNo]      |xpath                       |
|$headerNo=                  |getHeaderColumnNumber;                      |//div[contains(@class,'row label')]//div[contains(@class,'seclabel')]//span            |xpath|Service provider state|
|$service_provider_state=    |getText;                                    |(//div[contains(@class,'row label')]//div[contains(@class,'sectext')]//span)[$headerNo]|xpath                       |
|$headerNo=                  |getHeaderColumnNumber;                      |//div[contains(@class,'row label')]//div[contains(@class,'seclabel')]//span            |xpath|GSTIN                 |
|$gstin=                     |getText;                                    |(//div[contains(@class,'row label')]//div[contains(@class,'sectext')]//span)[$headerNo]|xpath                       |
|$headerNo=                  |getHeaderColumnNumber;                      |//div[contains(@class,'row label')]//div[contains(@class,'seclabel')]//span            |xpath|GST Method            |
|$gst_method=                |getText;                                    |(//div[contains(@class,'row label')]//div[contains(@class,'sectext')]//span)[$headerNo]|xpath                       |
|$headerNo=                  |getHeaderColumnNumber;                      |//div[contains(@class,'row label')]//div[contains(@class,'seclabel')]//span            |xpath|IGST(12%)             |
|$igst_value=                |getText;                                    |(//div[contains(@class,'row label')]//div[contains(@class,'sectext')]//span)[$headerNo]|xpath                       |
|click;                      |//div[contains(@class,'close-sidebar')]     |xpath                                                                                                               |
|wait;                       |5                                                                                                                                                                |
|clickJS;                    |//a[text()='Preview']                       |xpath                                                                                                               |
|wait;                       |10                                                                                                                                                               |

!|script   |common                                                          |
|check     |checkIfStringAreEqual;|$invoice_number        |inv$num     |true|
|check     |checkIfStringAreEqual;|$place_of_supply       |Tamil Nadu  |true|
|check     |checkIfStringAreEqual;|$service_provider_state|Haryana     |true|
|check     |checkIfStringAreEqual;|$gstin                 |gst$unique  |true|
|check     |checkIfStringAreEqual;|$gst_method            |Forward     |true|
|check     |checkIfStringAreEqual;|$igst_value            |1,320       |true|
|check     |checkIfStringAreEqual;|$billtoparty_value     |Source Depot|true|
|$tresult1=|checkIfStringAreEqual;|$billtoparty_value     |Source Depot     |
**!

!**> Validating the print preview
!|script           |common                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|$expected_content=|getTrim;|REMARKS remarks $unique Powered by pando This is an electronic invoice issued in accordance with the provisions of the InformationTechnology Act, 2000 (21 of 2000). Hence, does not require any signature or digital signature PLACE OF SUPPLY: TAMIL NADU 11000 1320.00 12320 TOTAL TAXABLE VALUE: TAX IGST 12% TOTAL INVOICE VALUE BILL TO PARTY SRF LTD. NO 22,MAIN STREET, S$unique - 600344, GSTIN : 6667645465 SERVICE PROVIDER STATE: HARYANA GST: GST$unique TAX PAYABLE ON REVERSE CHARGE: NO SERVICE DESCRIPTION: MOVEMENT OF GOODS BY ROAD HSN/SAC: - PO NUMBER: - S SRF LOGISTICS CHENNAI, CHENNAI - 600001 TAMIL NADU inv$num $todayDate$ordinalDateSuffix $monthAndYear ORIGINAL FOR RECIPIENT TAX INVOICE Indent ID DeliveryMode Vehicle Type Taxable Value SRF-s$unique-M- 2 FTL v$unique MRT 6000 SRF-s$unique-M- 1 FTL v$unique MRT 5000 REMARKS remarks $unique Powered by pando This is an electronic invoice issued in accordance with the provisions of the InformationTechnology Act, 2000 (21 of 2000). Hence, does not require any signature or digital signature PLACE OF SUPPLY: TAMIL NADU 11000 1320.00 12320 TOTAL TAXABLE VALUE: TAX IGST 12% TOTAL INVOICE VALUE BILL TO PARTY SRF LTD. NO 22,MAIN STREET, S$unique - 600344, GSTIN : 6667645465 SERVICE PROVIDER STATE: HARYANA GST: GST$unique TAX PAYABLE ON REVERSE CHARGE: NO SERVICE DESCRIPTION: MOVEMENT OF GOODS BY ROAD HSN/SAC: - PO NUMBER: - S SRF LOGISTICS CHENNAI, CHENNAI - 600001 TAMIL NADU inv$num $todayDate$ordinalDateSuffix $monthAndYear DUPLICATE FOR SUPPLIER TAX INVOICE Indent ID DeliveryMode Vehicle Type Taxable Value SRF-s$unique-M- 2 FTL v$unique MRT 6000 SRF-s$unique-M- 1 FTL v$unique MRT 5000|

!|script       |common                    |
|$downloadPath=|getPath;|download|fullpath|

!|script         |FileUtil                          |
|$filename=      |getLastModifiedFile;|$downloadPath|
|$actual_content=|readPdfFile;        |$filename    |

!|Script            |Common                                                          |
|$difference_in_pdf=|stringCompareForDifference;|$actual_content   |$expected_content|
|check              |checkIfStringAreEqual;     |$difference_in_pdf|[]     |true     |
|$tresult2=         |checkIfStringAreEqual;     |$difference_in_pdf|[]               |

!|script               |common                    |
|$downloadPath=        |getPath;|download|fullpath|
|cleanFilesInDirectory;|$downloadPath             |

!**> Validating test result
!|script          |common                                                     |
|check            |checkIfStringAreEqualInArray;|$tresult1,$tresult2,true|true|
|$shipper_tresult=|checkIfStringAreEqualInArray;|$tresult1,$tresult2,true     |
*!
*!

!**> Validating test result
!|script  |common                                                                       |
|check    |checkIfStringAreEqualInArray;|$transporter_tresult,$shipper_tresult,true|true|
|$tresult=|checkIfStringAreEqualInArray;|$transporter_tresult,$shipper_tresult,true     |
*!