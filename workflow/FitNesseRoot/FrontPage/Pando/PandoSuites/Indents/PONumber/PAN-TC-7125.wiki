---
Help: Validate PO number with legal entity in indent collection,updating po number and verify freight bill posting,also checking freight bill preview
Suites: pg
Test
---
!5 Test Coverage:
!5 Create Indent 1 with LE1 mapped to Transporter T1 & Purchase order PO1 and verify whether PO number PO1 is taken
!5 Update PO number of LE1 to PO2
!5 Create Indent 2 with LE1 mapped to Transporter T1 & Purchase order PO1 and verify whether updated PO number PO2 is taken
!5 Validate indent collection in mongoDB and freight bill posting whether correct LE and PO numbers are populated
!5 Expected: After PO update, Indent 1 should have PO1 and Indent 2 should have PO2
!5 Check freight bill preview and verify the LE and PO numbers for both indents in pdf file

!**> Unique values assignment
!|Script |Common                                     |
|$unique=|getCurrentDateTimeStamp;|yMMddHHmmss       |
|$num1=  |getRandomNumber;        |20     |76        |
|$num2=  |getRandomNumber;        |1000   |9999      |
|$rand1= |getRandomString;        |2      |ALPHAUPPER|
|$year=  |getSubString;           |$unique|0    |4   |
|$indate=|getCurrentDateTimeStamp;|yyyy/MM/dd        |
|$vno_1= |getRandomNumber;        |20     |76        |
|$vno_2= |getRandomString;        |2      |ALPHAUPPER|
|$vno_3= |getRandomNumber;        |1000   |9999      |

!|Script                    |DateUtil                                                 |
|$contractDate=             |dateCalculation;               |dd-MMM-yyyy         |2   |
|$invoicedate=              |dateCalculation;               |dd-MM-yyyy          |2   |
|$loadingDate=              |dateCalculation;               |yyyy/MM/dd          |-2  |
|$truckindate=              |dateCalculation;               |yyyy/MM/dd          |-5  |
|$truckoutdate=             |dateCalculation;               |yyyy/MM/dd          |-1  |
|$monthAndYear=             |dateCalculation;               |MMMM yyyy           |0   |
|$todayDate=                |dateCalculation;               |d                   |0   |
|$ordinalDateSuffix=        |getOrdinalDateSuffix;          |$todayDate               |
|$thisday=                  |dateCalculation;               |dd                  |0   |
|$nMinus1day=               |getNPreviousDateInCurrentMonth;|$thisday            |-1|0|
|$nMinus3day=               |getNPreviousDateInCurrentMonth;|$thisday            |-3|1|
|$nMinus5day=               |getNPreviousDateInCurrentMonth;|$thisday            |-5|1|
|$nMinus4day=               |getNPreviousDateInCurrentMonth;|$thisday            |-4|1|
|$today=                    |getNPreviousDateInCurrentMonth;|$thisday            |0 |1|
|$expected_date_in_postgres=|dateCalculation;               |yyyy-MM-dd HH:mm:00Z|-1  |

!|Script       |Common                                        |
|$truckindate= |stringConcatenation;|$truckindate |!- $timer-!|
|$truckoutdate=|stringConcatenation;|$truckoutdate|!- $timer-!|

!|Script       |DateUtil                    |
|$loadingDate= |utcConversion;|$loadingDate |
|$truckindate= |utcConversion;|$truckindate |
|$truckoutdate=|utcConversion;|$truckoutdate|

!define truck_no {TN $vno_1 $vno_2 $vno_3}
*!

!**> Data creation
!**> Depot Creation
!define depot_name {d$unique}
!define depot_state {Tamil Nadu}
!define depot_city {dc$unique}
!define depot_region {South}
!define depot_short_code {D$num}
!define depot_reference_id {R$unique}
!define depot_address {No 15,GST Street}
!define depot_pincode {123456}
!define depot_gstn_no {123}
!define depot_delivery_type {1}
!define depot_phone {123}
!include -c .FrontPage.Pando.PandoSuites.PandoAPI.DataManager.DepotCreationAPI
*!

!**> Gate Manager Creation
!*** User Role ID Retrival
!define key {name}
!define role_type {gate_manager}
!define retrieve_key {id}
!include -c .FrontPage.Pando.PandoSuites.PandoAPI.DataManager.GetUserRoleAPI
*!

!define role_id {$retrieve_key_value}
!define user_number {123}
!define user_name {u$unique}
!define user_email {pandoindent+$unique@gmail.com}
!define status {1}
!include -c .FrontPage.Pando.PandoSuites.PandoAPI.DataManager.UserCreationAPI
*!

!**> Gate Creation
!define depot_id {$depot}
!define gate_name {Gate 1}
!define gate_ref_id {RG$unique}
!define gate_city {${depot_city}}
!define gate_state {${depot_state}}
!define gate_region {${depot_region}}
!define gate_pincode {${depot_pincode}}
!define gate_short_code {G1$num}
!define gate_user_id {$user_id}
!include -c .FrontPage.Pando.PandoSuites.PandoAPI.DataManager.GateCreationAPI

!|Script  |json                                |
|$gate_id=|getValueFromJSON;|$depotResp|data.id|
*!

!**> Adding newly created depot to the client config for Freight bill
!|Script                              |MongoDB                                      |
|initialize;                          |${connection}|${database}                    |
|wait;                                |2                                            |
|updateFreightBillClientConfiguration;|${surl}      |category2|start_day|$nMinus3day|
|updateFreightBillClientConfiguration;|${surl}      |category2|end_day  |$today     |
|updateFreightBillClientConfiguration;|${surl}      |category3|start_day|$nMinus5day|
|updateFreightBillClientConfiguration;|${surl}      |category3|end_day  |$today     |
#|addToFreightBillClientConfiguration; |${surl}      |category4|depots   |$depot     |
*!

!**> Consignee Creation
!define consignee_name {c1$unique}
!define consignee_ref_id {cr1$unique}
!define address {Egmore}
!define city {cc$unique}
!define state {Madya Pradesh}
!define pincode {520122}
!define manager_name {Manager Automation1}
!define manager_mobile {123}
!define manager_email {pandoconsignee+1$unique@gmail.com}
!define region {South}
!define site {1}

!include -c  .FrontPage.Pando.PandoSuites.PandoAPI.DataManager.ConsigneeCreationAPI

!|Script             |Common                      |
|$consignee_id_1=    |getTrim;|$consignee_id      |
|$consignee_id_ref_1=|getTrim;|${consignee_ref_id}|
**!

!**> Transporter Creation
!define transporter_name {t$unique}
!define transporter_ref_id {tr$unique}
!define address {Ashok Nager}
!define city {Chennai}
!define state {Tamil Nadu}
!define pincode {600083}
!define manager_name {Manager $unique}
!define manager_mobile {123}
!define manager_email {pandotransporter+$unique@outlook.com}
!define pancard {AUYPD33324L}

!include -c  .FrontPage.Pando.PandoSuites.PandoAPI.DataManager.TransporterCreationAPI
**!

!**> Retrieving Password for the Created Transporter 
!include -c .FrontPage.Pando.Common.CommonTransporterPassword
*!

!**> Vehicle Creation
!define vehicle_name {v$unique MRT}
!define cft {2048}
!define kg {12000}
!define vehicle_type {FTL}

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.DataManager.VehicleCreationAPI
*!

!**> Material Creation
!define material_name {m$unique}
!define material_code {mc$unique}

!|script|common                                                                                                                                                                                                                                                                                                                           |
|$data= |getTrim;|{"data":{"name":"${material_name}","code":"${material_code}","business_unit":"${business_unit}","piece_per_box":"${piece_per_box}","box_width":"${box_width}","box_length":"${box_length}","box_height":"${box_height}","box_weight":"${box_weight}","box_volume":"${box_volume}","category":"PC$unique","pallets":"1"}}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.DataManager.MaterialCreationDynamicAPI
**!

!**> Purchase order creation
!define ponumber {po$unique}
!define netvalue {10000}
!define balvalue {5000}
!define legalentity {le$unique}
!define validfrom {2021-01-01}
!define validto {2025-12-31}

!define row {Purchase Order Number,Purchase Order Net Value,Purchase Order Balance value,Transporter Ref ID,Legal Entity,Valid From(YYYY-MM-DD),Valid To(YYYY-MM-DD)}
!define column {${ponumber},${netvalue},${balvalue},${transporter_ref_id},${legalentity},${validfrom},${validto}}

!include -c .FrontPage.Pando.PandoSuites.DataManager.CommonPOupload

!|script                     |ui                                                                                          |
|refresh;                                                                                                                 |
|sendKeys;                   |//input[@placeholder='Search by PO number']|xpath                               |${ponumber}|
|waitForElementToBeDisplayed;|//span[contains(text(),'po$unique')]       |xpath                               |10         |
|check                       |isElementPresent;                          |//span[contains(text(),'tr$unique')]|xpath |true|
|check                       |isElementPresent;                          |//span[contains(text(),'le$unique')]|xpath |true|
**!

!**> Uploading Rate Matrix
!define row {Type*,Source*,Destination*,Vehicle Type*,Distance,Transporter Reference ID*,Transporter Name,Transit Days*,Freight Rate*,Freight Unit*,Valid From*,Valid To*,Minimum Rate,Multiplying Factor,Detention Group,Product Category,Fixed Rate,ODA Rate,Oda Unit,Minimum ODA,Point Charges,Is Dedicated,Truck Count,Slab Kms,Min Kms,Additional Charge Percentage,Hilly Region Addition Percentage,Is Round Trip Eligible,Return Freight Rate,Exclude,Trip Count}
!define column {City,dc$unique,cc$unique,${vehicle_name},700,$transporter_ref_id,$transporter_name,1,3000.50,per ton,01-Jan-$year,31-Dec-2030,100,1,U,,100,1,per_kg,100,150,,,0-250,600,15,22,,}
!include -c  .FrontPage.Pando.Common.RateMatrix
*!
**!

!** Indent creation 1
!**> Direct Dispatch Indent creation
!define delivery_number {d1$unique}
!define mrp_price {1000}
!define material_code {mc$unique}
!define depot_ref_id {R$unique}
!define gate_ref_id {RG$unique}
!define division {${legalentity}}
!define quantity {100}
!define quantity_unit {NOS}
!define weight {10000}
!define weight_unit {KG}
!define volume {1024}
!define volume_unit {CFT}
!define ship_to {cr1$unique}
!define sold_to {cr1$unique}
!define type {Secondary}
!define shipment_number {s1$unique}
!define invoice_number {INV1$unique}
!define invoice_amount {10000}
!define category {20a}
!define lr_number {lr1$unique}
!define invoice_date {$invoicedate}
!define transporter {tr$unique}
!define vehicle_type {v$unique MRT}
!define vehicle_number {TN $vno_1 $vno_2 $vno_3}
!define lr_number {lr1$unique}

!|Script|Http                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|$data= |getJsonTrim;|{"data":[{"delivery_number":"${delivery_number}","mrp_price":"${mrp_price}","material_code":"${material_code}","depot_ref_id":"${depot_ref_id}","gate_ref_id":"${gate_ref_id}","division":"${division}","quantity":"${quantity}","quantity_unit":"${quantity_unit}","weight":"${weight}","weight_unit":"${weight_unit}","volume":"${volume}","volume_unit":"${volume_unit}","ship_to":"${ship_to}","sold_to":"${sold_to}","type":"${type}","shipment_number":"${shipment_number}","invoice_number":"${invoice_number}","invoice_amount":"${invoice_amount}","category":"${category}","invoice_date":"${invoice_date}","transporter":"${transporter}","vehicle_type":"${vehicle_type}","vehicle_number":"${vehicle_number}","lr_number":"${lr_number}","truck_out":""}]}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Indent.IndentDirectDispatchAPI
*!

!**> Filter indent after direct_dispatch
!|script       |ui             |
|navigateToUrl;|${surl}/indents|

!define search_text {${depot_name}}
!include -c .FrontPage.Pando.PandoSuites.Indents.IndentSearch.CommonIndentDepotFilter

!define search_text {$unique}
!include -c .FrontPage.Pando.PandoSuites.Indents.IndentSearch.CommonIndentSearch

!|script                     |ui                                                                                                                                                                                        |
|refresh;                                                                                                                                                                                                               |
|waitForElementToBeDisplayed;|//span[normalize-space(text())='t$unique']//ancestor::div[contains(@class,'order-row')]|xpath                                                                                  |30        |
|check                       |isElementPresent;                                                                      |//span[normalize-space(text())='t$unique']//ancestor::div[contains(@class,'order-row')]|xpath|true|
|$tresult1=                  |isElementPresent;                                                                      |//span[normalize-space(text())='t$unique']//ancestor::div[contains(@class,'order-row')]|xpath     |
|mouseHover;                 |(//div[contains(@class,'order-id')])[2]//span[contains(@class,'tooltip')]              |xpath                                                                                             |
|$order_id_1=                |getText;                                                                               |(//div[@role='tooltip' and contains(@style,'absolute')]/child::div)                    |xpath     |
**!

!**> verify LE in indents collection with PO number 1
!|Script             |MongoDB                                                                       |
|initialize;         |${connection}           |${database}                                          |
|$purchase_order_doc=|getValuesFromCollection;|indents|order_no|$order_id_1|purchase_order_documents|

!|Script  |Common                                                   |
|$poarray=|stringConcatenation; |"podocuments":|$purchase_order_doc |
|$poarray=|stringConcatenation; |$poarray      |end                 |
|$pojson= |getSubStringByString;|$poarray      |"podocuments":[|]end|

!|script   |json                                  |
|$ponumber=|getValueFromJSON;|$pojson|po_number   |
|$lenumber=|getValueFromJSON;|$pojson|legal_entity|

!|Script   |Common                                              |
|check     |checkIfStringAreEqual;|$ponumber|${ponumber}   |true|
|$tresult2=|checkIfStringAreEqual;|$ponumber|${ponumber}        |
|check     |checkIfStringAreEqual;|$lenumber|${legalentity}|true|
|$tresult3=|checkIfStringAreEqual;|$lenumber|${legalentity}     |
**!

!**> LR Attachment via Mobile App
!define consignee_id {$consignee_id_1}
!define cusername {pandoconsignee+1$unique@gmail.com}
!define cpassword {12345}

!** Creating attachable LR file
!|Script   |Common                                            |
|$filePath=|getPath;|testAttachment/images/lr1$unique|fullpath|

!|Script        |Ui       |
|takeScreenshot;|$filePath|
*!

!** Uploading LR file to s3
!|Script     |Common                                        |
|$order_id=  |getTrim;             |$order_id_1             |
|$domain_url=|stringConcatenation; |${surl}    |xxx         |
|$domain_url=|getSubStringByString;|$domain_url|https://|xxx|

!|Script       |MongoDB                                                    |
|$attachableId=|getValuesFromCollection;|indents|order_no  |$order_id  |_id|
|$clientId=    |getValuesFromCollection;|clients|domain_url|$domain_url|_id|

!|Script       |Common                                          |
|$filePath=    |getTrim;             |$filePath!-.png-!         |
|$attachableId=|getSubStringByString;|$attachableId|{"$oid":"|"}|
|$clientId=    |getSubStringByString;|$clientId    |{"$oid":"|"}|

!define attachableId {$attachableId}
!define clientId {$clientId}
!define attachableType {order}
!include .FrontPage.Pando.PandoSuites.PandoAPI.ConsigneeAPI.UploadLRViaConsigneeMobileAppAPI
*!

!** Updating the attachment ID to the Indent created
!|script|common                                                   |
|$data= |getTrim;|{"data":{"lr_attachment_ids":["$attachmentId"]}}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.ConsigneeAPI.UpdateLRViaConsigneeMobileAppAPI
*!
*!

!**> EPOD submission through Consignee APP
!define consignee_id {$consignee_id_1}
!include .FrontPage.Pando.PandoSuites.PandoAPI.ERPIntegration.GetMaterialThroughConsigneeMobileAppAPI

!|Script|Common                                                                                                                                                                                                                                                                 |
|$data= |getTrim;|{"data":{"materials":[{"id":"$material_ref_id","leakage_count":"0","damage_count":"1","excess_count":"0","shortage_count":"2","carton_damage_count":"3","comment":"","shortage_charge":"20","damage_charge":"10","carton_damage_charge":"30"}],"packages":[]}}|

!include .FrontPage.Pando.PandoSuites.PandoAPI.ERPIntegration.GRNSubmissionThroughConsigneeMobileApp

!**> Verify EPOD submission
!|Script                     |Ui                                                                                                                                                          |
|refresh;                                                                                                                                                                                 |
|click;                      |//span[text()='Document']             |xpath                                                                                                                |
|waitForElementToBeDisplayed;|//div[contains(@class,'card-content')]|xpath                                                                                              |30               |
|$epodstatus_column=         |getHeaderColumnNumber;                |//div[@class='el-table__header-wrapper']//div[@class='cell']                                       |xpath|EPOD status|
|$material_row_number=       |getHeaderColumnNumber;                |//div[contains(@class,'scrolling')]//span[contains(text(),'kg')]                                   |xpath|10000 kg   |
|$epodstatus=                |getText;                              |((//div[contains(@class,'el-table__body')]//td[$epodstatus_column])[$material_row_number]//span)[2]|xpath            |

!|Script   |Common                                           |
|check     |checkIfStringAreEqual;|$epodstatus|Submitted|true|
|$tresult4=|checkIfStringAreEqual;|$epodstatus|Submitted     |
**!
**!

!**> Verify LR Upload from mobile is reflected in shipper
!|Script   |Ui                                                                                                                                                                                                                                        |
|check     |isElementPresent;                                                                      |//span[@class='el-upload-list__item-preview']/../self::span[contains(@class,'actions')]                                                |xpath|true|
|$tresult5=|isElementPresent;                                                                      |//span[@class='el-upload-list__item-preview']/../self::span[contains(@class,'actions')]                                                |xpath     |
|click;    |//span[@class='el-upload-list__item-preview']/../self::span[contains(@class,'actions')]|xpath                                                                                                                                             |
|check     |isElementPresent;                                                                      |//div[@class='drawer-body']//span[starts-with(text(),'le$unique')]/following-sibling::strong/span[normalize-space(text())='lr1$unique']|xpath|true|
**!

!**> Marking Indent as delivered
!define consignee_id {$consignee_id}
!define arrived_at {$loadingDate}
!define dispatched_at {$loadingDate}

!|script|common                                                                                                                |
|$data= |getTrim;|{"data":[{"destination_id":"${consignee_id}","reported_at":"${arrived_at}","release_at":"${dispatched_at}"}]}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Indent.MarkAsDeliveredAPI

!|script       |ui                                                                                                                  |
|navigateToUrl;|${surl}/indents                                                                                                     |
|refresh;                                                                                                                           |
|check         |isElementPresent;|//span[normalize-space(text())='t$unique']//ancestor::div[contains(@class,'order-row')]|xpath|true|
|check         |isElementPresent;|//div[contains(text(),'Delivered')]                                                    |xpath|true|
*!
**!

!** Indent creation 2
!**> Update new PO number in Purchase order creation
!define ponumber2 {npo$unique}
!define netvalue {10000}
!define balvalue {5000}
!define legalentity {le$unique}
!define validfrom {2021-01-01}
!define validto {2025-12-31}

!define row {Purchase Order Number,Purchase Order Net Value,Purchase Order Balance value,Transporter Ref ID,Legal Entity,Valid From(YYYY-MM-DD),Valid To(YYYY-MM-DD)}
!define column {${ponumber2},${netvalue},${balvalue},${transporter_ref_id},${legalentity},${validfrom},${validto}}

!include -c .FrontPage.Pando.PandoSuites.DataManager.CommonPOupload

!|script                     |ui                                                                                           |
|refresh;                                                                                                                  |
|sendKeys;                   |//input[@placeholder='Search by PO number']|xpath                               |${ponumber2}|
|waitForElementToBeDisplayed;|//span[contains(text(),'npo$unique')]      |xpath                               |10          |
|check                       |isElementPresent;                          |//span[contains(text(),'tr$unique')]|xpath |true |
|check                       |isElementPresent;                          |//span[contains(text(),'le$unique')]|xpath |true |
**!

!**> Direct Dispatch Indent creation 2
!define shipment_number {s2$unique}

!|Script|Http                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|$data= |getJsonTrim;|{"data":[{"delivery_number":"d2$unique","mrp_price":"${mrp_price}","material_code":"${material_code}","depot_ref_id":"${depot_ref_id}","gate_ref_id":"${gate_ref_id}","division":"${division}","quantity":"${quantity}","quantity_unit":"${quantity_unit}","weight":"${weight}","weight_unit":"${weight_unit}","volume":"${volume}","volume_unit":"${volume_unit}","ship_to":"${ship_to}","sold_to":"${sold_to}","type":"${type}","shipment_number":"${shipment_number}","invoice_number":"${invoice_number}","invoice_amount":"${invoice_amount}","category":"${category}","invoice_date":"${invoice_date}","transporter":"${transporter}","vehicle_type":"${vehicle_type}","vehicle_number":"${vehicle_number}","lr_number":"${lr_number}","truck_out":""}]}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Indent.IndentDirectDispatchAPI
*!

!**> Filter indent after direct_dispatch
!|script       |ui             |
|navigateToUrl;|${surl}/indents|
|refresh;                      |

!|script     |ui                                                                                                                                                                               |
|check       |isElementPresent;                                                        |(//span[normalize-space(text())='t$unique']//ancestor::div[contains(@class,'order-row')])[2]|xpath|true|
|$tresult6=  |isElementPresent;                                                        |(//span[normalize-space(text())='t$unique']//ancestor::div[contains(@class,'order-row')])[2]|xpath     |
|mouseHover; |(//div[contains(@class,'order-id')])[3]//span[contains(@class,'tooltip')]|xpath                                                                                                  |
|$order_id_2=|getText;                                                                 |(//div[@role='tooltip' and contains(@style,'absolute')]/child::div)                         |xpath     |
**!

!**> verify LE for indent 2 in indents collection
!|Script             |MongoDB                                                                       |
|$purchase_order_doc=|getValuesFromCollection;|indents|order_no|$order_id_2|purchase_order_documents|

!|Script  |Common                                                   |
|$poarray=|stringConcatenation; |"podocuments":|$purchase_order_doc |
|$poarray=|stringConcatenation; |$poarray      |end                 |
|$pojson= |getSubStringByString;|$poarray      |"podocuments":[|]end|

!|script   |json                                  |
|$ponumber=|getValueFromJSON;|$pojson|po_number   |
|$lenumber=|getValueFromJSON;|$pojson|legal_entity|

!|Script   |Common                                              |
|check     |checkIfStringAreEqual;|$ponumber|${ponumber2}  |true|
|$tresult7=|checkIfStringAreEqual;|$ponumber|${ponumber2}       |
|check     |checkIfStringAreEqual;|$lenumber|${legalentity}|true|
|$tresult8=|checkIfStringAreEqual;|$lenumber|${legalentity}     |
**!

!**> verify LE for indent 1 in indents collection
!|Script             |MongoDB                                                                     |
|$purchase_order_doc=|getValuesFromCollection;|indents|order_no|$order_id|purchase_order_documents|

!|Script  |Common                                                   |
|$poarray=|stringConcatenation; |"podocuments":|$purchase_order_doc |
|$poarray=|stringConcatenation; |$poarray      |end                 |
|$pojson= |getSubStringByString;|$poarray      |"podocuments":[|]end|

!|script   |json                                  |
|$ponumber=|getValueFromJSON;|$pojson|po_number   |
|$lenumber=|getValueFromJSON;|$pojson|legal_entity|

!|Script    |Common                                              |
|check      |checkIfStringAreEqual;|$ponumber|${ponumber}   |true|
|$tresult9= |checkIfStringAreEqual;|$ponumber|${ponumber}        |
|check      |checkIfStringAreEqual;|$lenumber|${legalentity}|true|
|$tresult10=|checkIfStringAreEqual;|$lenumber|${legalentity}     |
**!

!**> LR Attachment via Mobile App
!define cusername {pandoconsignee+1$unique@gmail.com}
!define cpassword {12345}

!** Creating attachable LR file
!|Script   |Common                                            |
|$filePath=|getPath;|testAttachment/images/lr2$unique|fullpath|

!|Script        |Ui       |
|takeScreenshot;|$filePath|
*!

!** Uploading LR file to s3
!|Script     |Common                                        |
|$order_id=  |getTrim;             |$order_id_2             |
|$domain_url=|stringConcatenation; |${surl}    |xxx         |
|$domain_url=|getSubStringByString;|$domain_url|https://|xxx|

!|Script       |MongoDB                                                    |
|$attachableId=|getValuesFromCollection;|indents|order_no  |$order_id  |_id|
|$clientId=    |getValuesFromCollection;|clients|domain_url|$domain_url|_id|

!|Script       |Common                                          |
|$filePath=    |getTrim;             |$filePath!-.png-!         |
|$attachableId=|getSubStringByString;|$attachableId|{"$oid":"|"}|
|$clientId=    |getSubStringByString;|$clientId    |{"$oid":"|"}|

!define attachableId {$attachableId}
!define clientId {$clientId}
!define attachableType {order}
!include .FrontPage.Pando.PandoSuites.PandoAPI.ConsigneeAPI.UploadLRViaConsigneeMobileAppAPI
*!

!** Updating the attachment ID to the Indent created
!|script|common                                                   |
|$data= |getTrim;|{"data":{"lr_attachment_ids":["$attachmentId"]}}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.ConsigneeAPI.UpdateLRViaConsigneeMobileAppAPI
*!
*!

!**> EPOD submission through Consignee APP
!define consignee_id {$consignee_id_1}
!include .FrontPage.Pando.PandoSuites.PandoAPI.ERPIntegration.GetMaterialThroughConsigneeMobileAppAPI

!|Script|Common                                                                                                                                                                                                                                                                 |
|$data= |getTrim;|{"data":{"materials":[{"id":"$material_ref_id","leakage_count":"0","damage_count":"1","excess_count":"0","shortage_count":"2","carton_damage_count":"3","comment":"","shortage_charge":"20","damage_charge":"10","carton_damage_charge":"30"}],"packages":[]}}|

!include .FrontPage.Pando.PandoSuites.PandoAPI.ERPIntegration.GRNSubmissionThroughConsigneeMobileApp

!**> Verify EPOD submission
!|Script                     |Ui                                                                                                                                                          |
|refresh;                                                                                                                                                                                 |
|click;                      |//span[text()='Document']             |xpath                                                                                                                |
|waitForElementToBeDisplayed;|//div[contains(@class,'card-content')]|xpath                                                                                              |30               |
|$epodstatus_column=         |getHeaderColumnNumber;                |//div[@class='el-table__header-wrapper']//div[@class='cell']                                       |xpath|EPOD status|
|$material_row_number=       |getHeaderColumnNumber;                |//div[contains(@class,'scrolling')]//span[contains(text(),'kg')]                                   |xpath|10000 kg   |
|$epodstatus=                |getText;                              |((//div[contains(@class,'el-table__body')]//td[$epodstatus_column])[$material_row_number]//span)[2]|xpath            |

!|Script    |Common                                           |
|check      |checkIfStringAreEqual;|$epodstatus|Submitted|true|
|$tresult11=|checkIfStringAreEqual;|$epodstatus|Submitted     |
**!

!**> Verify LR Upload from mobile is reflected in shipper
!|Script    |Ui                                                                                                                                                                                                                                        |
|check      |isElementPresent;                                                                      |//span[@class='el-upload-list__item-preview']/../self::span[contains(@class,'actions')]                                                |xpath|true|
|$tresult12=|isElementPresent;                                                                      |//span[@class='el-upload-list__item-preview']/../self::span[contains(@class,'actions')]                                                |xpath     |
|click;     |//span[@class='el-upload-list__item-preview']/../self::span[contains(@class,'actions')]|xpath                                                                                                                                             |
|check      |isElementPresent;                                                                      |//div[@class='drawer-body']//span[starts-with(text(),'le$unique')]/following-sibling::strong/span[normalize-space(text())='lr1$unique']|xpath|true|
**!

!**> Marking Indent as delivered
!define consignee_id {$consignee_id}
!define arrived_at {$loadingDate}
!define dispatched_at {$loadingDate}

!|script|common                                                                                                                |
|$data= |getTrim;|{"data":[{"destination_id":"${consignee_id}","reported_at":"${arrived_at}","release_at":"${dispatched_at}"}]}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Indent.MarkAsDeliveredAPI

!|script                     |ui                                                                                                                                    |
|navigateToUrl;              |${surl}/indents                                                                                                                       |
|refresh;                                                                                                                                                           |
|waitForElementToBeDisplayed;|//span[normalize-space(text())='t$unique']//ancestor::div[contains(@class,'order-row')]|xpath                              |30        |
|check                       |isElementPresent;                                                                      |//div[contains(text(),'Delivered')]|xpath|true|
*!
**!

!**> Validating result
!|Script                  |Common                                                                                                                                                            |
|check                    |checkIfStringAreEqualInArray;|$tresult1,$tresult2,$tresult3,$tresult4,$tresult5,$tresult6,$tresult7,$tresult8,$tresult9,$tresult10,$tresult11,$tresult12,true|true|
|$indentcollection_result=|checkIfStringAreEqualInArray;|$tresult1,$tresult2,$tresult3,$tresult4,$tresult5,$tresult6,$tresult7,$tresult8,$tresult9,$tresult10,$tresult11,$tresult12,true     |
*!
**!

!** Check freight bill posting
!**> Login to Transporter
!define transporter_email {pandotransporter+$unique@outlook.com}
!define transporter_password {$password}

!include -c .FrontPage.Pando.Common.TransporterLogin
*!

!**> Checking the Freight bill posted
!|script                     |ui                                                                                                                                                |
|click;                      |//li[@class='app-side-menu']                      |xpath                                                                                          |
|click;                      |//li/a[contains(text(),'Pay')]                    |xpath                                                                                          |
|click;                      |//li[@class='app-side-menu']/following-sibling::li|xpath                                                                                          |
|click;                      |//li/span[text()='Freight Bill']                  |xpath                                                                                          |
|waitForElementToBeDisplayed;|//div[contains(@class,'grid-list-row')]           |xpath                                                                                    |20   |
|$freight_bill_no=           |getText;                                          |(//span[text()='CATEGORY2']/ancestor::div[contains(@class,'grid-list-row')]/div)[1]//span|xpath|
|$other_charges_bill_no=     |getText;                                          |(//span[text()='CATEGORY3']/ancestor::div[contains(@class,'grid-list-row')]/div)[1]//span|xpath|
*!

!**> Changing the Freight end day for the category 2 and category 3
!|Script                              |MongoDB                              |
|updateFreightBillClientConfiguration;|${surl}|category2|end_day|$nMinus1day|
|updateFreightBillClientConfiguration;|${surl}|category3|end_day|$nMinus1day|
*!

!**> Changing the Freight bill end day for the category 2 and category 3 in Postgres DB
!define updatequery_1 {update public."FreightBills" set expected_erp_post_date='$expected_date_in_postgres' where bill_no='$freight_bill_no';}
!define updatequery_2 {update public."FreightBills" set expected_erp_post_date='$expected_date_in_postgres' where bill_no='$other_charges_bill_no';}

!|script|PostgresDB                                               |
|$db1=  |updateDataInPostgresDb;|${pg_connection}|${updatequery_1}|
|$db2=  |updateDataInPostgresDb;|${pg_connection}|${updatequery_2}|
**!

!** Generate Invoice
!**> Check preview and Generate invoice for cat 2
!define fb_category {CATEGORY2}
!define fb_order_id {$order_id!--cat2-!}

!** Validating the print preview for freight bill
!|script       |common                    |
|$downloadPath=|getPath;|download|fullpath|

!|script                     |ui                                                                               |
|click;                      |//span[text()='${fb_category}']                                         |xpath   |
|waitForElementToBeDisplayed;|//div[@class='el-table__fixed']//span[contains(text(),'${fb_order_id}')]|xpath|20|
|click;                      |//a[contains(text(),'Preview')]                                         |xpath   |
|wait;                       |3                                                                                |

!|Script               |Common                       |
|$uniquecaps=          |upperCase;|$unique           |
|$freight_bill_no_caps=|upperCase;|$freight_bill_no  |
|$monthAndYear=        |upperCase;|$monthAndYear     |
|$ordinalDateSuffix=   |upperCase;|$ordinalDateSuffix|

!|script           |common                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|$expected_content=|getTrim;|Powered by pando This is an electronic invoice issued in accordance with the provisions of the InformationTechnology Act, 2000 (21 of 2000). Hence, does not require any signature or digital signature t T$uniquecaps ASHOK NAGER CHENNAI - 600083 TAMIL NADU GSTIN: 123 ORIGINAL FOR RECIPIENT FREIGHT BILL BILL TO PARTY P&G-AUTO NO 15,GST STREET, DC$uniquecaps - 123456, LEGAL ENTITY EXEMPTED/NON EXEMPTED PO NUMBER AMOUNT LE$uniquecaps NON EXEMPTED PO$uniquecaps 3072512.00 LE$uniquecaps NON EXEMPTED NPO$uniquecaps 3072512.00 TOTAL VALUE 6145024 $freight_bill_no_caps $todayDate$ordinalDateSuffix $monthAndYear Powered by pando This is an electronic invoice issued in accordance with the provisions of the InformationTechnology Act, 2000 (21 of 2000). Hence, does not require any signature or digital signature t T$uniquecaps ASHOK NAGER CHENNAI - 600083 TAMIL NADU GSTIN: 123 DUPLICATE FOR SUPPLIER FREIGHT BILL BILL TO PARTY P&G-AUTO NO 15,GST STREET, DC$uniquecaps - 123456, LEGAL ENTITY EXEMPTED/NON EXEMPTED PO NUMBER AMOUNT LE$uniquecaps NON EXEMPTED PO$uniquecaps 3072512.00 LE$uniquecaps NON EXEMPTED NPO$uniquecaps 3072512.00 TOTAL VALUE 6145024 $freight_bill_no_caps $todayDate$ordinalDateSuffix $monthAndYear|

!|script         |FileUtil                          |
|$filename=      |getLastModifiedFile;|$downloadPath|
|$actual_content=|readPdfFile;        |$filename    |

!|Script            |Common                                                          |
|$difference_in_pdf=|stringCompareForDifference;|$actual_content   |$expected_content|
|check              |checkIfStringAreEqual;     |$difference_in_pdf|[]     |true     |
|$previewresult_1=  |checkIfStringAreEqual;     |$difference_in_pdf|[]               |

!|script               |common                    |
|$downloadPath=        |getPath;|download|fullpath|
|cleanFilesInDirectory;|$downloadPath             |
*!

!include -c .FrontPage.Pando.PandoSuites.Indents.FreightWorkingV2.PGFrieghtBill.CommonFreightbillGenerateForCategory

!|script   |common                                                     |
|$tresult1=|checkIfStringAreEqual;|$total_freight_bill_amount|3072512  |
|$tresult2=|checkIfStringAreEqual;|$total_invoice_value      |61,45,024|
**!

!**> Check preview and Generate invoice for cat 3
!define fb_category {CATEGORY3}
!define fb_order_id {$order_id!--cat3-!}

!** Validating the print preview for other bill
!|script       |common                    |
|$downloadPath=|getPath;|download|fullpath|

!|script                     |ui                                                                               |
|navigateToUrl;              |${turl}/v2/freight                                                               |
|click;                      |//span[text()='${fb_category}']                                         |xpath   |
|waitForElementToBeDisplayed;|//div[@class='el-table__fixed']//span[contains(text(),'${fb_order_id}')]|xpath|20|
|click;                      |//a[contains(text(),'Preview')]                                         |xpath   |
|wait;                       |3                                                                                |

!|Script                     |Common                           |
|$other_charges_bill_no_caps=|upperCase;|$other_charges_bill_no|

!|script           |common                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|$expected_content=|getTrim;|Powered by pando This is an electronic invoice issued in accordance with the provisions of the InformationTechnology Act, 2000 (21 of 2000). Hence, does not require any signature or digital signature t T$uniquecaps ASHOK NAGER CHENNAI - 600083 TAMIL NADU GSTIN: 123 ORIGINAL FOR RECIPIENT FREIGHT BILL BILL TO PARTY P&G-AUTO NO 15,GST STREET, DC$uniquecaps - 123456, LEGAL ENTITY EXEMPTED/NON EXEMPTED PO NUMBER AMOUNT LE$uniquecaps NON EXEMPTED PO$uniquecaps 10100.00 LE$uniquecaps NON EXEMPTED NPO$uniquecaps 10100.00 TOTAL VALUE 20200 $other_charges_bill_no_caps $todayDate$ordinalDateSuffix $monthAndYear Powered by pando This is an electronic invoice issued in accordance with the provisions of the InformationTechnology Act, 2000 (21 of 2000). Hence, does not require any signature or digital signature t T$uniquecaps ASHOK NAGER CHENNAI - 600083 TAMIL NADU GSTIN: 123 DUPLICATE FOR SUPPLIER FREIGHT BILL BILL TO PARTY P&G-AUTO NO 15,GST STREET, DC$uniquecaps - 123456, LEGAL ENTITY EXEMPTED/NON EXEMPTED PO NUMBER AMOUNT LE$uniquecaps NON EXEMPTED PO$uniquecaps 10100.00 LE$uniquecaps NON EXEMPTED NPO$uniquecaps 10100.00 TOTAL VALUE 20200 $other_charges_bill_no_caps $todayDate$ordinalDateSuffix $monthAndYear|

!|script         |FileUtil                          |
|$filename=      |getLastModifiedFile;|$downloadPath|
|$actual_content=|readPdfFile;        |$filename    |

!|Script            |Common                                                          |
|$difference_in_pdf=|stringCompareForDifference;|$actual_content   |$expected_content|
|check              |checkIfStringAreEqual;     |$difference_in_pdf|[]     |true     |
|$previewresult_2=  |checkIfStringAreEqual;     |$difference_in_pdf|[]               |

!|script               |common                    |
|$downloadPath=        |getPath;|download|fullpath|
|cleanFilesInDirectory;|$downloadPath             |
*!

!include -c .FrontPage.Pando.PandoSuites.Indents.FreightWorkingV2.PGFrieghtBill.CommonFreightbillGenerateForCategory

!|script|ui|
|wait;  |5 |

!|script   |common                                                  |
|$tresult3=|checkIfStringAreEqual;|$total_freight_bill_amount|10100 |
|$tresult4=|checkIfStringAreEqual;|$total_invoice_value      |20,200|
*!
**!

!**> Checking the Generated Freight bill in shipper login and Approving the bill
!include -c .FrontPage.Pando.Common.ShipperInvoiceFilter

!include -c .FrontPage.Pando.Common.ShipperIndentSearch

!|script                     |ui                                                                                                                                                                                                                            |
|check                       |isElementPresent;                                                                    |//div[contains(@class,'card-row row')]//*[normalize-space(text())='$freight_bill_no']                                   |xpath|true     |
|check                       |isElementPresent;                                                                    |//span[contains(text(),'61,45,024')]//ancestor::div[contains(@class,'card-row row')]//span[contains(text(),'Generated')]|xpath|true     |
|check                       |isElementPresent;                                                                    |//div[contains(@class,'card-row row')]//*[normalize-space(text())='$other_charges_bill_no']                             |xpath|true     |
|check                       |isElementPresent;                                                                    |//span[contains(text(),'20,200')]//ancestor::div[contains(@class,'card-row row')]//span[contains(text(),'Generated')]   |xpath|true     |
|click;                      |//div[contains(@class,'card-row row')]//*[normalize-space(text())='$freight_bill_no']|xpath                                                                                                                                   |
|waitForElementToBeDisplayed;|//div[contains(@class,'scrolling')]//table[@class='el-table__body']//tbody           |xpath                                                                                                                   |20             |
|click;                      |//button[contains(text(),'Summary')]                                                 |xpath                                                                                                                                   |
|click;                      |//span[contains(text(),'Approve')] /../self::button                                  |xpath                                                                                                                                   |
|click;                      |//div[@class='el-message-box']//span[contains(text(),'YES')]                         |xpath                                                                                                                                   |
|waitForElementToBeDisplayed;|//h3[text()='Success']/following-sibling::span                                       |xpath                                                                                                                   |30             |
|$successMessage=            |getElementAttribute;                                                                 |//h3[text()='Success']/following-sibling::span                                                                          |xpath|innerText|
|click;                      |//div[contains(@class,'searchterm ')]//i[contains(@class,'close')]                   |xpath                                                                                                                                   |

!5 Waiting for Freight bill posting to happen

!|script|ui|
|wait;  |90|
*!

!**> Validating the Freight bill payload sent to ERP (On Approving Freight Bill) for indent 1 and indent 2
!|Script                         |MongoDBQuery                                                                                                                                     |
|getMongoConnection;             |${connection}                                   |db_pando_testing                                                                                |
|$freight_bill_posting_payload_1=|getFreightBillPostingPayload;                   |invoice_number  |$freight_bill_no                                                               |
|$totalNoOfpayloadSent1=         |getTotalNoOfFreightBillPostingPayloadSent;      |invoice_number  |$freight_bill_no                                                               |
|check                           |getValuesFromFreightBillPostingPayload;         |invoice_number  |$freight_bill_no                                                               |
|check                           |getValuesFromFreightBillPostingPayload;         |transporter_code|tr$unique                                                                      |
|check                           |getValuesFromFreightBillPostingPayload;         |invoice_total   |6145024                                                                        |
|check                           |getValuesFromFreightBillPostingPayload;         |currency        |INR                                                                            |
|check                           |getIndentsValuesFromFreightBillPostingPayload;  |indent_id       |$order_id_1|movement_type    |1                                                |
|check                           |getIndentsValuesFromFreightBillPostingPayload;  |indent_id       |$order_id_1|indent_id        |$order_id_1                                      |
|check                           |getLegalEntitiyFromFreightBillPostingPayload;   |indent_id       |$order_id_1|legal_entity_code|${legalentity}                                   |
|check                           |getMaterialDetailsFromFreightBillPostingPayload;|indent_id       |$order_id_1|delivery_number  |${delivery_number}|order_no       |$order_id_1   |
|check                           |getMaterialDetailsFromFreightBillPostingPayload;|indent_id       |$order_id_1|delivery_number  |${delivery_number}|purchase_order |${ponumber}   |
|check                           |getMaterialDetailsFromFreightBillPostingPayload;|indent_id       |$order_id_1|delivery_number  |${delivery_number}|delivery_number|d1$unique     |
|check                           |getMaterialDetailsFromFreightBillPostingPayload;|indent_id       |$order_id_1|delivery_number  |${delivery_number}|legal_entity   |${legalentity}|
|check                           |getIndentsValuesFromFreightBillPostingPayload;  |indent_id       |$order_id_2|movement_type    |1                                                |
|check                           |getIndentsValuesFromFreightBillPostingPayload;  |indent_id       |$order_id_2|indent_id        |$order_id_2                                      |
|check                           |getLegalEntitiyFromFreightBillPostingPayload;   |indent_id       |$order_id_2|legal_entity_code|${legalentity}                                   |
|check                           |getMaterialDetailsFromFreightBillPostingPayload;|indent_id       |$order_id_2|delivery_number  |d2$unique         |order_no       |$order_id_2   |
|check                           |getMaterialDetailsFromFreightBillPostingPayload;|indent_id       |$order_id_2|delivery_number  |d2$unique         |purchase_order |${ponumber2}  |
|check                           |getMaterialDetailsFromFreightBillPostingPayload;|indent_id       |$order_id_2|delivery_number  |d2$unique         |delivery_number|d2$unique     |
|check                           |getMaterialDetailsFromFreightBillPostingPayload;|indent_id       |$order_id_2|delivery_number  |d2$unique         |legal_entity   |${legalentity}|

!|script   |common                                               |
|check     |comparisonResult;|$totalNoOfpayloadSent1|equal|1|true|
|$tresult5=|comparisonResult;|$totalNoOfpayloadSent1|equal|1     |

!|Script         |Common                                                             |
|$schemaFilePath=|getPath;|data/schemafiles/freight_bill_posting_schema.json|fullpath|

!|script|json                                                                      |
|check  |validateJsonDocument;|$schemaFilePath|$freight_bill_posting_payload_1|true|

!|script|ui|
|wait;  |10|
*!

!**> Other bill Approval
!include -c .FrontPage.Pando.Common.ShipperInvoiceFilter

!include -c .FrontPage.Pando.Common.ShipperIndentSearch

!|script                     |ui                                                                                                                                                        |
|click;                      |//div[contains(@class,'card-row row')]//*[normalize-space(text())='$other_charges_bill_no']|xpath                                                         |
|waitForElementToBeDisplayed;|//div[contains(@class,'scrolling')]//table[@class='el-table__body']//tbody                 |xpath                                         |20             |
|click;                      |//button[contains(text(),'Summary')]                                                       |xpath                                                         |
|click;                      |//span[contains(text(),'Approve')] /../self::button                                        |xpath                                                         |
|click;                      |//div[@class='el-message-box']//span[contains(text(),'YES')]                               |xpath                                                         |
|waitForElementToBeDisplayed;|//h3[text()='Success']/following-sibling::span                                             |xpath                                         |30             |
|$successMessage=            |getElementAttribute;                                                                       |//h3[text()='Success']/following-sibling::span|xpath|innerText|
|click;                      |//div[contains(@class,'searchterm ')]//i[contains(@class,'close')]                         |xpath                                                         |

!5 Waiting for Freight bill posting to happen

!|script|ui|
|wait;  |90|
*!

!**> Validating the Freight bill payload sent to ERP (On Approving Other charges Freight Bill) for indent 1 and indent 2
!|Script                         |MongoDBQuery                                                                                                                                     |
|getMongoConnection;             |${connection}                                   |db_pando_testing                                                                                |
|$freight_bill_posting_payload_2=|getFreightBillPostingPayload;                   |invoice_number  |$other_charges_bill_no                                                         |
|$totalNoOfpayloadSent2=         |getTotalNoOfFreightBillPostingPayloadSent;      |invoice_number  |$other_charges_bill_no                                                         |
|check                           |getValuesFromFreightBillPostingPayload;         |invoice_number  |$other_charges_bill_no                                                         |
|check                           |getValuesFromFreightBillPostingPayload;         |transporter_code|tr$unique                                                                      |
|check                           |getValuesFromFreightBillPostingPayload;         |invoice_total   |20200                                                                          |
|check                           |getValuesFromFreightBillPostingPayload;         |currency        |INR                                                                            |
|check                           |getIndentsValuesFromFreightBillPostingPayload;  |indent_id       |$order_id_1|movement_type    |1                                                |
|check                           |getIndentsValuesFromFreightBillPostingPayload;  |indent_id       |$order_id_1|indent_id        |$order_id_1                                      |
|check                           |getLegalEntitiyFromFreightBillPostingPayload;   |indent_id       |$order_id_1|legal_entity_code|${legalentity}                                   |
|check                           |getMaterialDetailsFromFreightBillPostingPayload;|indent_id       |$order_id_1|delivery_number  |${delivery_number}|order_no       |$order_id_1   |
|check                           |getMaterialDetailsFromFreightBillPostingPayload;|indent_id       |$order_id_1|delivery_number  |${delivery_number}|purchase_order |${ponumber}   |
|check                           |getMaterialDetailsFromFreightBillPostingPayload;|indent_id       |$order_id_1|delivery_number  |${delivery_number}|delivery_number|d1$unique     |
|check                           |getMaterialDetailsFromFreightBillPostingPayload;|indent_id       |$order_id_1|delivery_number  |${delivery_number}|legal_entity   |${legalentity}|
|check                           |getIndentsValuesFromFreightBillPostingPayload;  |indent_id       |$order_id_2|movement_type    |1                                                |
|check                           |getIndentsValuesFromFreightBillPostingPayload;  |indent_id       |$order_id_2|indent_id        |$order_id_2                                      |
|check                           |getLegalEntitiyFromFreightBillPostingPayload;   |indent_id       |$order_id_2|legal_entity_code|${legalentity}                                   |
|check                           |getMaterialDetailsFromFreightBillPostingPayload;|indent_id       |$order_id_2|delivery_number  |d2$unique         |order_no       |$order_id_2   |
|check                           |getMaterialDetailsFromFreightBillPostingPayload;|indent_id       |$order_id_2|delivery_number  |d2$unique         |purchase_order |${ponumber2}  |
|check                           |getMaterialDetailsFromFreightBillPostingPayload;|indent_id       |$order_id_2|delivery_number  |d2$unique         |delivery_number|d2$unique     |
|check                           |getMaterialDetailsFromFreightBillPostingPayload;|indent_id       |$order_id_2|delivery_number  |d2$unique         |legal_entity   |${legalentity}|

!|script   |common                                               |
|check     |comparisonResult;|$totalNoOfpayloadSent2|equal|1|true|
|$tresult6=|comparisonResult;|$totalNoOfpayloadSent2|equal|1     |

!|Script         |Common                                                             |
|$schemaFilePath=|getPath;|data/schemafiles/freight_bill_posting_schema.json|fullpath|

!|script|json                                                                      |
|check  |validateJsonDocument;|$schemaFilePath|$freight_bill_posting_payload_2|true|
*!

!**> Validating result
!|Script                    |Common                                                                                             |
|check                      |checkIfStringAreEqualInArray;|$tresult1,$tresult2,$tresult3,$tresult4,$tresult5,$tresult6,true|true|
|$freightbillposting_result=|checkIfStringAreEqualInArray;|$tresult1,$tresult2,$tresult3,$tresult4,$tresult5,$tresult6,true     |
*!
**!

!**> Validating final result
!|Script  |Common                                                                                                                       |
|check    |checkIfStringAreEqualInArray;|$indentcollection_result,$freightbillposting_result,$previewresult_1,$previewresult_2,true|true|
|$tresult=|checkIfStringAreEqualInArray;|$indentcollection_result,$freightbillposting_result,$previewresult_1,$previewresult_2,true     |
*!

!**> Reverting the Freight bill configuration to default
!|Script                              |MongoDB                       |
|updateFreightBillClientConfiguration;|${surl}|category1|start_day|1 |
|updateFreightBillClientConfiguration;|${surl}|category1|end_day  |15|
|updateFreightBillClientConfiguration;|${surl}|category2|start_day|16|
|updateFreightBillClientConfiguration;|${surl}|category2|end_day  |31|
|updateFreightBillClientConfiguration;|${surl}|category3|start_day|1 |
|updateFreightBillClientConfiguration;|${surl}|category3|end_day  |31|
*!