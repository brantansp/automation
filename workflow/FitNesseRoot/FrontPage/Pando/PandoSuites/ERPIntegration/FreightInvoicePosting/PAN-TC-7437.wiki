---
Help: Validate payments replicating data in production for SHHJ depot - with unloading, damage and carton damage,SLA breach - reassigned, RFQ debit for primary indent
Suites: marico2
Test
---
!** Test coverage
Replicated MAR-PN2C-OM-6236 from production
1. freight charge per trip along with SLA breach-Reassigned and reconciled - without invoice posting
2. Tranporter discount 2.5% charges
3. No SDCD or other charges
**!

!** Prerequisite - production data
[Referred indent: MAR-SHHJ-M-1643 - SLA Breach- Reassigned,RFQ debit,SDCD]
Source Depot- SHHJ - gate - SHHJ
Destination  depots -  Hubli - Depot - D677
Materials - 716971,720462,717051
Transporters- SUBHAM FREIGHT CARRIERS INDIA(T2) ,DELHIVERY FREIGHT SERVICES(T1)
Vehicle - Single Axle 9 MT, Double Axle 16 MT
Rate matrix - city contract with 21186.51638 per trip for Single Axle 9 MT - DELHIVERY FREIGHT SERVICES(T1)
SLA admin settings and SLA DM
open indent settings in admin
**!

!***> Unique values assignment
!|Script      |Common                                     |
|$unique=     |getCurrentDateTimeStamp;|yMMddHHmmss       |
|$num=        |getRandomNumber;        |100    |999       |
|$num1=       |getRandomNumber;        |20     |76        |
|$num2=       |getRandomNumber;        |1000   |9999      |
|$rand1=      |getRandomString;        |2      |ALPHAUPPER|
|$year=       |getSubString;           |$unique|0    |4   |
|$indate=     |getCurrentDateTimeStamp;|yyyy/MM/dd        |
|$vno_1=      |getRandomNumber;        |20     |76        |
|$vno_2=      |getRandomString;        |2      |ALPHAUPPER|
|$vno_3=      |getRandomNumber;        |1000   |9999      |
|$invoicedate=|getCurrentDateTimeStamp;|yyyy-MM-dd        |

!|Script            |DateUtil                          |
|$monthAndYear=     |dateCalculation;     |MMMM yyyy |0|
|$todayDate=        |dateCalculation;     |d         |0|
|$ordinalDateSuffix=|getOrdinalDateSuffix;|$todayDate  |
|$paydate=          |dateCalculation;     |yyyy/MM/dd|2|

!|Script  |Common                                     |
|$paydate=|stringConcatenation;|$paydate|!- 10:00:00-!|

!define truck_no {TN $vno_1 $vno_2 $vno_3}
*!

!***> Destination Depot Creation
!define destination_depot_name {Hubli - Depot}
!define destination_depot_id {61e9858c74cb330049d4fd96}
!define destination_depot_refid {D677}
!define destination_depot_gateid {D677}
!define destination_depot_gate {61e985d97ac5ba0049ea5078}

!|script                       |common                            |
|$destination_location_id=     |getTrim;|${destination_depot_id}  |
|$destination_gate_location_id=|getTrim;|${destination_depot_gate}|
*!

!***> Transporter 1 with discount
!define transporter_name_1 {DELHIVERY FREIGHT SERVICES}
!define transporter_ref_id_1 {402850}
!define discount {1.5}
!define gst_percentage {5}
!define manager_email {pandotransporter+delhivery@outlook.com}
!define transporter_id_1 {61e7ea2db472c9004499191d}

!| Script          |Common                      |
|$transporter_id_1=|getTrim;|${transporter_id_1}|
*!

!**> Retrieving Password for the Created Transporter 
!include -c .FrontPage.Pando.Common.CommonTransporterPassword

!| Script    |Common            |
|$password_1=|getTrim;|$password|
*!

!***> Transporter 2 with discount
!define transporter_name_2 {SUBHAM FREIGHT CARRIERS INDIA}
!define transporter_ref_id_2 {401914}
!define discount {2.5}
!define gst_percentage {12}
!define manager_email {pandotransporter+subham@outlook.com}
!define transporter_id_2 {61e7e621b472c90044991912}

!| Script          |Common                      |
|$transporter_id_2=|getTrim;|${transporter_id_2}|

!**> Retrieving Password for the Created Transporter 
!include -c .FrontPage.Pando.Common.CommonTransporterPassword

!| Script    |Common            |
|$password_2=|getTrim;|$password|
*!
*!

!***> Vehicle Creation
!define vehicle_name_1 {Single Axle 9 MT}
!define cft {882}
!define kg {9000}
!define vehicle_type {FTL}
!define vehicle_id_1 {61e9875cfb5c3a004947b884}

!| Script      |Common                  |
|$vehicle_id_1=|getTrim;|${vehicle_id_1}|
*!

!***> Vehicle Creation
!define vehicle_name_2 {Double Axle 16 MT}
!define cft {1077}
!define kg {16000}
!define vehicle_type {FTL}
!define vehicle_id_2 {61e9865dfb5c3a004947b856}

!| Script      |Common                  |
|$vehicle_id_2=|getTrim;|${vehicle_id_2}|
*!

!***> Source Depot Creation
!define depot_name {SHHJ}
!define depot_reference_id {SHHJ}
!define source_depot_id {61e9849e74cb330049d4fd94}
!define depot_gate_id {SHHJ}
!define source_gate_id {61e9853d74cb330049d4fd95}

!|Script         |Common                     |
|$location_id=   |getTrim;|${source_depot_id}|
|$source_gate_id=|getTrim;|${source_gate_id} |
*!

!** Loading/Unloading charges upload
!define row {Vehicle Type,Movement,Depot REF ID,Loading cost,Unloading cost,ODA cost,Unit}
!define column {${vehicle_name_1},Primary,D677,0,200,0,Per Trip|${vehicle_name_2},Primary,D677,0,200,0,Per Trip}

!include -c .FrontPage.Pando.PandoSuites.Transporter.Payments.CommonLoadingUnloadingBulkUpload
**!

!** Uploading the SLA Contract
!define Vehicle_Type {Double Axle 16 MT}
!define Depot_Ref_Id {SHHJ}
!define Movement {Primary}

!|script|common       |
|$rand1=|getTrim;|0   |
|$rand2=|getTrim;|0   |
|$rand3=|getTrim;|1700|
|$rand4=|getTrim;|0   |
|$rand5=|getTrim;|0   |

!include -c .FrontPage.Pando.PandoSuites.DataManager.CommonSLAUpload
*!

!***> Uploading Rate Matrix
!define row {Type*,Source*,Destination*,Vehicle Type*,Distance,Transporter Reference ID*,Transporter Name,Transit Days*,Freight Rate*,Freight Unit*,Valid From*,Valid To*,Minimum Rate,Multiplying Factor,Detention Group,Exclude,Trip Count}
!define column {City,Tirumala-Hyderabad,Hubli,${vehicle_name_1},5,${transporter_ref_id_1},${transporter_name_1},2,21186.51638,per_trip,01-Jan-$year,31-Dec-2030,0,0,U}

!include -c .FrontPage.Pando.Common.RateMatrix
*!

!**> SLA Setting in Admin
!|Script               |DateUtil                   |
|waitForRoundoffMinute;|30                         |
|$indentCutoffHour=    |dateCalculation;|minute|H|3|
|$indentCutoffMin=     |dateCalculation;|minute|m|3|
|$arrivalCutoffHour=   |dateCalculation;|minute|H|4|
|$arrivalCutoffMin=    |dateCalculation;|minute|m|4|

!|script|common                                                                                                                                                                                                                                                              |
|$data= |getTrim;|{"data":{"depot_ids":["$location_id"],"movement":2,"sla_configurations":[{"sla_type":2,"hours":$indentCutoffHour,"mins":$indentCutoffMin},{"sla_type":1,"hours":$arrivalCutoffHour,"mins":$arrivalCutoffMin},{"sla_type":3,"days":4,"hours":22,"mins":0}]}}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Settings.AdminSlaSettingAPI
*!

!** Open indent settings in admin settings
!define dest_depot_id {$location_id}
!define movement {2}

!|Script|Http                                                                                                                                                                                                                   |
|$data= |getJsonTrim;|{"data":{"depot_ids":["${dest_depot_id}"],"movement":${movement},"open_indents_charge":{"loading_charge":true,"loading_detention_charge":true,"unloading_charge":true,"unloading_detention_charge":true}}}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.AdminSettings.OpenIndentAdminSettingsAPI
**!

!**> Indent Creation
!|Script                   |DateUtil                                  |
|$vehicle_requirement_date=|dateCalculation;|yyyy/MM/dd      |-1      |
|$vehicle_requirement_date=|utcConversion;  |$vehicle_requirement_date|

!|Script               |DateUtil                                            |
|$expected_delivery_at=|dateCalculation;|yyyy/MM/dd            |0           |
|$expected_delivery_at=|utcConversion;  |$expected_delivery_at !- 10:00:00-!|

!define order_type  {0}
!define transporter_id {$transporter_id_1}
!define vehicle_type_id {$vehicle_id_1}
!define location_id {$location_id}
!define gate_id {$source_gate_id}
!define vehicle_requirement_date {$vehicle_requirement_date}
!define loader_available {false}
!define add_to_invoice {false}
!define indent_type {2}
!define destination_location_id {$destination_location_id}
!define sold_to_id {$destination_gate_location_id}
!define unloader_available {false}
!define expected_delivery_at {$expected_date}

!|script|common                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|$data= |getTrim;|{"data":{"order_type":${order_type},"transporter_id":"${transporter_id}","vehicle_type_id":"${vehicle_type_id}","sources":[{"type":1,"location_id":"${location_id}","gate_id":"${gate_id}","vehicle_requirement_date":"${vehicle_requirement_date}","loader_available":${loader_available},"add_to_invoice":${add_to_invoice}}],"destinations":[{"type":1,"location_id":"${destination_location_id}","source_location_id":"${location_id}","source_gate_id":"${gate_id}","sold_to_id":"${sold_to_id}","unloader_available":${unloader_available},"add_to_invoice":${add_to_invoice},"gate_id":"${sold_to_id}"}],"no_of_vehicles": 1}}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Indent.IndentCreationDynamicAPI

!|script           |DateUtil                         |
|$indentCreateTime=|dateCalculation;|minute|hh:mm:a|0|
*!

!***> Adding Truck details
!define vechicle_number {${truck_no}}
!define driver_name {d$unique}
!define phone_number {1234567890}

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Indent.TruckAssignAPI
*!

!** Wait for SLA Breach
!|Script|Ui |
|wait;  |300|
**!

!** Shipper Bid Request To Transporter
!|Script           |DateUtil                                               |
|$truckindate=     |dateCalculation;  |yyyy/MM/dd  |0                      |
|$truckindateDelay=|dateCalculation;  |minute      |hh:mm:a       |0       |
|$truckindate=     |appendDateAndTime;|$truckindate|!- $truckindateDelay -!|
|$truck_in_date=   |utcConversion;    |$truckindate                        |

!|Script|Common                                                                                                                        |
|$data= |getTrim;|{"data":{"loading_date":"$truck_in_date","transporter_ids":["$transporter_id_2"],"freight_unit":1,"ceiling_price":0}}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Indent.RfqSendBidRequest
**!

!** Bids quotes from transporter side
!|Script     |DateUtil                                    |
|$arrival_at=|getCurrentDateTimeStamp;|yyyy/MM/dd HH:mm:ss|
|$arrival_at=|utcConversion;          |$arrival_at        |

!|script      |common        |
|$randFreight=|getTrim;|45000|

!define freight_charge {$randFreight}
!define rfq_status {3}
!define vehicle_type_id {$vehicle_id_2}

!define tusername {pandotransporter+subham@outlook.com}
!define tpassword {$password_2}

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Indent.RfqStatus
**!

!** Bids Accepted by Shipper from Transporter
!|Script|Common                                                                                               |
|$data= |getTrim;|{"data":{"comment":"Accepted","quotes":[{"transporter_id":"$transporter_id_2","status":2}]}}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Indent.RfqAcceptBidRequest
**!

!***> Adding Truck details
!define vechicle_number {${truck_no}}
!define driver_name {d$unique}
!define phone_number {1234567890}

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Indent.TruckAssignAPI
*!

!*** Truck In
!|Script           |DateUtil                                               |
|$truckindate=     |dateCalculation;  |yyyy/MM/dd  |0                      |
|$truckindateDelay=|dateCalculation;  |minute      |hh:mm:a       |0       |
|$truckindate=     |appendDateAndTime;|$truckindate|!- $truckindateDelay -!|
|$truck_in_date=   |utcConversion;    |$truckindate                        |

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Indent.TruckInAPI
*!

!**> Update LR for Consignee
!define consignee_id {$destination_location_id}
!define lr_number {l1}

!|script|common                                                                                                                                                           |
|$data= |getTrim;|{"data":[{"destination_id":"${destination_depot_id}","source_location_id":"${source_depot_id}","gate_id":"${destination_depot_gate}","lr_number":"L1"}]}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Indent.LRUpdateDynamicAPI
**!

!**> Material upload for all consignee
!|Script            |DateUtil                                                 |
|$truckoutdate=     |dateCalculation;  |yyyy/MM/dd   |0                       |
|$truckoutdateDelay=|dateCalculation;  |minute       |hh:mm:a        |0       |
|$truckoutdate=     |appendDateAndTime;|$truckoutdate|!- $truckoutdateDelay -!|
|$truckoutdate=     |utcConversion;    |$truckoutdate                         |

!|script|common                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|$data= |getTrim;|{"data":[{"indent_no":"$order_id","delivery_number":"D1$unique","mrp_price":"3980","material_code":"716971","depot_ref_id":"SHHJ","gate_ref_id":"SHHJ","division":"80","quantity":"200","quantity_unit":"CS","weight":"3960","weight_unit":"KG","volume":"225","volume_unit":"CFT","ship_to":"D677","sold_to":"D677","type":"Primary","invoice_number":"INV-$unique","invoice_amount":"547006","invoice_date":"$indate","category":"GT","truck_out":"$truckoutdate","cgst_rate":"0","cgst_amount":"0","sgst_rate":"0","sgst_amount":"0","igst_rate":"0","igst_amount":"0","hsn_code":"9965","material_taxable_amount":"0","ext_ref_id":""},{"indent_no":"$order_id","delivery_number":"D1$unique","mrp_price":"3580","material_code":"720462","depot_ref_id":"SHHJ","gate_ref_id":"SHHJ","division":"80","quantity":"250","quantity_unit":"CS","weight":"4865","weight_unit":"KG","volume":"281","volume_unit":"CFT","ship_to":"D677","sold_to":"D677","type":"Primary","invoice_number":"INV-$unique","invoice_amount":"698037","invoice_date":"$indate","category":"GT","truck_out":"$truckoutdate","cgst_rate":"0","cgst_amount":"0","sgst_rate":"0","sgst_amount":"0","igst_rate":"0","igst_amount":"0","hsn_code":"9965","material_taxable_amount":"0","ext_ref_id":""},{"indent_no":"$order_id","delivery_number":"D1$unique","mrp_price":"4576","material_code":"717051","depot_ref_id":"SHHJ","gate_ref_id":"SHHJ","division":"80","quantity":"350","quantity_unit":"CS","weight":"7070","weight_unit":"KG","volume":"562","volume_unit":"CFT","ship_to":"D677","sold_to":"D677","type":"Primary","invoice_number":"INV-$unique","invoice_amount":"987462","invoice_date":"$indate","category":"GT","truck_out":"$truckoutdate","cgst_rate":"0","cgst_amount":"0","sgst_rate":"0","sgst_amount":"0","igst_rate":"0","igst_amount":"0","hsn_code":"9965","material_taxable_amount":"0","ext_ref_id":""}]}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.ERPIntegration.MaterialInvoiceDynamicERPAPI
**!

!**> LR attachment
!|Script   |Common                                           |
|$pdfpath1=|getPath;|testAttachment/pdf1_$unique.pdf|fullpath|

!|Script               |FileUtil            |
|createFileFromContent;|$pdfpath1|test|UTF-8|

!|Script                     |Ui                                                     |
|navigateToUrl;              |${surl}/indents/$order_id/details/0                    |
|waitForElementToBeDisplayed;|//div[@class='card-right']//table      |xpath|15       |
|sendKeys;                   |(//input[@class='el-upload__input'])[1]|xpath|$pdfpath1|
|wait;                       |2                                                      |
*!

!**> Transporter login
!define transporter_email {${manager_email}}
!define transporter_password {$password_2}

!include -c .FrontPage.Pando.Common.TransporterLogin
**!

!**> Update S/D/CD in transporter
!|Script                     |Ui                                                                   |
|navigateToUrl;              |${turl}/indents/$order_id                                            |
|waitForElementToBeDisplayed;|//div[contains(@class,'card-content')]                      |xpath|30|
|click;                      |//span[normalize-space(text())='${destination_depot_name}'] |xpath   |
|click;                      |(//div[contains(@class,'cell-value')])[20]                  |xpath   |
|clearAndSend;               |(//input[@type='number'])[2]                                |xpath|8 |
|wait;                       |2                                                                    |
|click;                      |//span[@role='link' and normalize-space(text())='Documents']|xpath   |
|click;                      |(//div[contains(@class,'cell-value')])[21]                  |xpath   |
|clearAndSend;               |(//input[@type='number'])[1]                                |xpath|3 |
|clearAndSend;               |(//input[@type='number'])[2]                                |xpath|12|
|wait;                       |2                                                                    |
|click;                      |//span[@role='link' and normalize-space(text())='Documents']|xpath   |
|click;                      |(//div[contains(@class,'cell-value')])[23]                  |xpath   |
|clearAndSend;               |(//input[@type='number'])[2]                                |xpath|5 |
|wait;                       |2                                                                    |
|click;                      |//span[@role='link' and normalize-space(text())='Documents']|xpath   |
|click;                      |(//div[contains(@class,'cell-value')])[24]                  |xpath   |
|clearAndSend;               |(//input[@type='number'])[1]                                |xpath|2 |
|clearAndSend;               |(//input[@type='number'])[2]                                |xpath|15|
|wait;                       |2                                                                    |
|click;                      |//span[@role='link' and normalize-space(text())='Documents']|xpath   |
|wait;                       |2                                                                    |
|click;                      |//span[normalize-space(text())='Save']                      |xpath   |
|waitForElementToBeDisplayed;|//h3[text()='Success']                                      |xpath|30|
**!

!**> Mark as delivered
!|Script        |DateUtil                                      |
|$reported_date=|dateCalculation;  |yyyy/MM/dd    |0           |
|$timer=        |dateCalculation;  |hh:mm:a       |0           |
|$reported_date=|appendDateAndTime;|$reported_date|!- $timer -!|
|$reported_date=|utcConversion;    |$reported_date             |

!**> Wait for 1 minute
!|script|ui|
|wait;  |60|
**!

!|Script        |DateUtil                                      |
|$released_date=|dateCalculation;  |yyyy/MM/dd    |0           |
|$timer=        |dateCalculation;  |hh:mm:a       |0           |
|$released_date=|appendDateAndTime;|$released_date|!- $timer -!|
|$released_date=|utcConversion;    |$released_date             |

!|script|common                                                                                                                        |
|$data= |getTrim;|{"data":[{"destination_id":"$destination_location_id","release_at":"$released_date","reported_at":"$reported_date"}]}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.Indent.MarkAsDeliveredAPI 
**!

!*> Ready for billing page
!define filter_by {Enter indent id}
!define search_text {$order_id}

!|script                        |Ui                                                                                  |
|wait;                          |5                                                                                   |
|navigateToUrl;                 |${turl}/v2/payments?depot=${depot_name}                                             |
|refreshForElementToBeDisplayed;|(//div[contains(@class,'list-row') or contains(@class,'card-row row')])[1]|xpath|5|2|
|waitForElementToBeDisplayed;   |//div[starts-with(@class,'card-row row')]                                 |xpath|30 |
|click;                         |//span[normalize-space(text())='Filter']                                  |xpath    |
|click;                         |//button[text()='APPLY']                                                  |xpath    |
|wait;                          |5                                                                                   |
|refresh;                                                                                                            |

!include -c .FrontPage.Pando.Common.CommonSearchTrigger

!|script|Ui                                       |
|click; |//span[@class='el-checkbox__inner']|xpath|
|click; |//button[text()='Create Invoice']  |xpath|
*!

!**> Checking the charges in transporter invoice
!define header_name1 {Freight}
!define header_name2 {Transit Delay - 0 Days}
!define header_name3 {Loading}
!define header_name4 {Loading Detention - 0 Days}
!define header_name5 {UnLoading Detention - 0 Days}
!define header_name6 {ODA}
!define header_name7 {Fixed Charge}
!define header_name8 {Shortage}
!define header_name9 {Damage}
!define header_name10 {Carton Damage}
!define header_name11 {Unloading}
!define header_name12 {SLA Delay - 0 Days}

!|script                         |ui                                                                                                                                                                                                                                                                 |
|click;                          |//div[@class='el-table__fixed']//*[normalize-space(text())='$order_id']               |xpath                                                                                                                                                                       |
|waitForElementToBeDisplayed;    |//div[@id='pane-Details']//div[starts-with(normalize-space(@class),'tab-content')]    |xpath                                                                                                                                                |15                    |
|click;                          |//div[@id='tab-Charges']                                                              |xpath                                                                                                                                                                       |
|waitForElementToBeDisplayed;    |//div[@id='pane-Charges']//div[starts-with(normalize-space(@class),'tab-content')]    |xpath                                                                                                                                                |15                    |
|$charges_header_column_number=  |getHeaderColumnNumber;                                                                |//div[@role='tablist' and contains(@class,'table')]/child::div//div[@class='cell']//span[not(contains(@class,'icon') or contains(@class,'position'))]|xpath|${header_name1} |
|$freight_shipper=               |getText;                                                                              |((//div[@role='tablist' and contains(@class,'table')]/child::div)[$charges_header_column_number]//div[starts-with(@class,'cell text-right')])[1]     |xpath                 |
|$freight_transporter=           |getValue;                                                                             |(//div[@role='tablist' and contains(@class,'table')]/child::div)[$charges_header_column_number]//input[@type='number']                               |xpath                 |
|$charges_header_column_number=  |getHeaderColumnNumber;                                                                |//div[@role='tablist' and contains(@class,'table')]/child::div//div[@class='cell']//span[not(contains(@class,'icon') or contains(@class,'position'))]|xpath|${header_name2} |
|$transitdelay_shipper=          |getText;                                                                              |((//div[@role='tablist' and contains(@class,'table')]/child::div)[$charges_header_column_number]//div[starts-with(@class,'cell text-right')])[1]     |xpath                 |
|$transitdelay_transporter=      |getValue;                                                                             |(//div[@role='tablist' and contains(@class,'table')]/child::div)[$charges_header_column_number]//input[@type='number']                               |xpath                 |
|$charges_header_column_number=  |getHeaderColumnNumber;                                                                |//div[@role='tablist' and contains(@class,'table')]/child::div//div[@class='cell']//span[not(contains(@class,'icon') or contains(@class,'position'))]|xpath|${header_name3} |
|$loading_shipper=               |getText;                                                                              |((//div[@role='tablist' and contains(@class,'table')]/child::div)[$charges_header_column_number]//div[starts-with(@class,'cell text-right')])[1]     |xpath                 |
|$loading_transporter=           |getValue;                                                                             |(//div[@role='tablist' and contains(@class,'table')]/child::div)[$charges_header_column_number]//input[@type='number']                               |xpath                 |
|$charges_header_column_number=  |getHeaderColumnNumber;                                                                |//div[@role='tablist' and contains(@class,'table')]/child::div//div[@class='cell']//span[not(contains(@class,'icon') or contains(@class,'position'))]|xpath|${header_name4} |
|$loadingdetention_shipper=      |getText;                                                                              |((//div[@role='tablist' and contains(@class,'table')]/child::div)[$charges_header_column_number]//div[starts-with(@class,'cell text-right')])[1]     |xpath                 |
|$loadingdetention_transporter=  |getValue;                                                                             |(//div[@role='tablist' and contains(@class,'table')]/child::div)[$charges_header_column_number]//input[@type='number']                               |xpath                 |
|$charges_header_column_number=  |getHeaderColumnNumber;                                                                |//div[@role='tablist' and contains(@class,'table')]/child::div//div[@class='cell']//span[not(contains(@class,'icon') or contains(@class,'position'))]|xpath|${header_name5} |
|$unloadingdetention_shipper=    |getText;                                                                              |((//div[@role='tablist' and contains(@class,'table')]/child::div)[$charges_header_column_number]//div[starts-with(@class,'cell text-right')])[1]     |xpath                 |
|$unloadingdetention_transporter=|getValue;                                                                             |(//div[@role='tablist' and contains(@class,'table')]/child::div)[$charges_header_column_number]//input[@type='number']                               |xpath                 |
|$charges_header_column_number=  |getHeaderColumnNumber;                                                                |//div[@role='tablist' and contains(@class,'table')]/child::div//div[@class='cell']//span[not(contains(@class,'icon') or contains(@class,'position'))]|xpath|${header_name6} |
|$oda_shipper=                   |getText;                                                                              |((//div[@role='tablist' and contains(@class,'table')]/child::div)[$charges_header_column_number]//div[starts-with(@class,'cell text-right')])[1]     |xpath                 |
|$oda_transporter=               |getValue;                                                                             |(//div[@role='tablist' and contains(@class,'table')]/child::div)[$charges_header_column_number]//input[@type='number']                               |xpath                 |
|$charges_header_column_number=  |getHeaderColumnNumber;                                                                |//div[@role='tablist' and contains(@class,'table')]/child::div//div[@class='cell']//span[not(contains(@class,'icon') or contains(@class,'position'))]|xpath|${header_name7} |
|$fixedrate_shipper=             |getText;                                                                              |((//div[@role='tablist' and contains(@class,'table')]/child::div)[$charges_header_column_number]//div[starts-with(@class,'cell text-right')])[1]     |xpath                 |
|$fixedrate_transporter=         |getValue;                                                                             |(//div[@role='tablist' and contains(@class,'table')]/child::div)[$charges_header_column_number]//input[@type='number']                               |xpath                 |
|$charges_header_column_number=  |getHeaderColumnNumber;                                                                |//div[@role='tablist' and contains(@class,'table')]/child::div//div[@class='cell']//span[not(contains(@class,'icon') or contains(@class,'position'))]|xpath|${header_name8} |
|$shortage_shipper=              |getText;                                                                              |((//div[@role='tablist' and contains(@class,'table')]/child::div)[$charges_header_column_number]//div[starts-with(@class,'cell text-right')])[1]     |xpath                 |
|$shortage_transporter=          |getValue;                                                                             |(//div[@role='tablist' and contains(@class,'table')]/child::div)[$charges_header_column_number]//input[@type='number']                               |xpath                 |
|$charges_header_column_number=  |getHeaderColumnNumber;                                                                |//div[@role='tablist' and contains(@class,'table')]/child::div//div[@class='cell']//span[not(contains(@class,'icon') or contains(@class,'position'))]|xpath|${header_name9} |
|$damage_shipper=                |getText;                                                                              |((//div[@role='tablist' and contains(@class,'table')]/child::div)[$charges_header_column_number]//div[starts-with(@class,'cell text-right')])[1]     |xpath                 |
|$damage_transporter=            |getValue;                                                                             |(//div[@role='tablist' and contains(@class,'table')]/child::div)[$charges_header_column_number]//input[@type='number']                               |xpath                 |
|$charges_header_column_number=  |getHeaderColumnNumber;                                                                |//div[@role='tablist' and contains(@class,'table')]/child::div//div[@class='cell']//span[not(contains(@class,'icon') or contains(@class,'position'))]|xpath|${header_name10}|
|$cartondamage_shipper=          |getText;                                                                              |((//div[@role='tablist' and contains(@class,'table')]/child::div)[$charges_header_column_number]//div[starts-with(@class,'cell text-right')])[1]     |xpath                 |
|$cartondamage_transporter=      |getValue;                                                                             |(//div[@role='tablist' and contains(@class,'table')]/child::div)[$charges_header_column_number]//input[@type='number']                               |xpath                 |
|$charges_header_column_number=  |getHeaderColumnNumber;                                                                |//div[@role='tablist' and contains(@class,'table')]/child::div//div[@class='cell']//span[not(contains(@class,'icon') or contains(@class,'position'))]|xpath|${header_name11}|
|$unloading_shipper=             |getText;                                                                              |((//div[@role='tablist' and contains(@class,'table')]/child::div)[$charges_header_column_number]//div[starts-with(@class,'cell text-right')])[1]     |xpath                 |
|$unloading_transporter=         |getValue;                                                                             |(//div[@role='tablist' and contains(@class,'table')]/child::div)[$charges_header_column_number]//input[@type='number']                               |xpath                 |
|$charges_header_column_number=  |getHeaderColumnNumber;                                                                |//div[@role='tablist' and contains(@class,'table')]/child::div//div[@class='cell']//span[not(contains(@class,'icon') or contains(@class,'position'))]|xpath|${header_name12}|
|$sladelay_shipper=              |getText;                                                                              |((//div[@role='tablist' and contains(@class,'table')]/child::div)[$charges_header_column_number]//div[starts-with(@class,'cell text-right')])[1]     |xpath                 |
|$sladelay_transporter=          |getValue;                                                                             |(//div[@role='tablist' and contains(@class,'table')]/child::div)[$charges_header_column_number]//input[@type='number']                               |xpath                 |
|$total_shipper=                 |getText;                                                                              |(//*[text()='TOTAL']/..//following-sibling::div)[1]                                                                                                  |xpath                 |
|$total_transporter=             |getText;                                                                              |(//*[text()='TOTAL']/..//following-sibling::div)[2]                                                                                                  |xpath                 |
|click;                          |//div[contains(text(),'$order_id')]/..//button//i[contains(@class,'el-dialog__close')]|xpath                                                                                                                                                                       |

!|Script|common                                                              |
|check  |checkIfStringAreEqual;|$freight_shipper               |45000   |true|
|check  |checkIfStringAreEqual;|$freight_transporter           |45000   |true|
|check  |checkIfStringAreEqual;|$transitdelay_shipper          |0       |true|
|check  |checkIfStringAreEqual;|$transitdelay_transporter      |0       |true|
|check  |checkIfStringAreEqual;|$loading_transporter           |0       |true|
|check  |checkIfStringAreEqual;|$loading_shipper               |0       |true|
|check  |checkIfStringAreEqual;|$loadingdetention_shipper      |0       |true|
|check  |checkIfStringAreEqual;|$loadingdetention_transporter  |0       |true|
|check  |checkIfStringAreEqual;|$unloadingdetention_shipper    |0       |true|
|check  |checkIfStringAreEqual;|$unloadingdetention_transporter|0       |true|
|check  |checkIfStringAreEqual;|$oda_shipper                   |0       |true|
|check  |checkIfStringAreEqual;|$oda_transporter               |0       |true|
|check  |checkIfStringAreEqual;|$fixedrate_shipper             |0       |true|
|check  |checkIfStringAreEqual;|$fixedrate_transporter         |0       |true|
|check  |checkIfStringAreEqual;|$shortage_shipper              |0       |true|
|check  |checkIfStringAreEqual;|$shortage_transporter          |0       |true|
|check  |checkIfStringAreEqual;|$damage_shipper                |0.65    |true|
|check  |checkIfStringAreEqual;|$damage_transporter            |0.65    |true|
|check  |checkIfStringAreEqual;|$cartondamage_shipper          |190.5   |true|
|check  |checkIfStringAreEqual;|$cartondamage_transporter      |190.5   |true|
|check  |checkIfStringAreEqual;|$unloading_shipper             |200     |true|
|check  |checkIfStringAreEqual;|$unloading_transporter         |200     |true|
|check  |checkIfStringAreEqual;|$sladelay_shipper              |0       |true|
|check  |checkIfStringAreEqual;|$sladelay_transporter          |0       |true|
|check  |checkIfStringAreEqual;|$total_shipper                 |45008.85|true|
|check  |checkIfStringAreEqual;|$total_transporter             |45008.85|true|
*!

!** Verify Summary
!|Script                     |Ui                                                                                                                                  |
|waitForElementToBeDisplayed;|//div[contains(@class,'table__body')]|xpath                                                                                   |20   |
|click;                      |//button[contains(text(),'Summary')] |xpath                                                                                         |
|$billtoparty_value=         |getValue;                            |//input[@placeholder='Select Bill to Party']                                            |xpath|
|$place_of_supply=           |getText;                             |//div[text()='PLACE OF SUPPLY']/../following-sibling::div//span[last()]                 |xpath|
|$gst_in=                    |getValue;                            |//div[normalize-space(text())='GSTIN']/../parent::div//following-sibling::div//input    |xpath|
|$gst_method=                |getText;                             |//div[text()='GST Method']/../following-sibling::div//div[contains(@class,'text')]      |xpath|
|$billtoparty_address=       |getText;                             |//div[text()='Bill to Party']/../parent::div/following::div[contains(@class,'bgfooter')]|xpath|
|$totalinvoicevalue=         |getText;                             |//div[@class='bgfooter']/div/div[@class='col-6 floatright']                             |xpath|
|$totaltaxablevalue=         |getText;                             |//span[contains(text(),'Total Taxable Value')]/../parent::div//following-sibling::div   |xpath|
|$discountvalue=             |getText;                             |//div[contains(text(),'discount (2.5%)')]/../following-sibling::div                     |xpath|
|$igst=                      |getText;                             |//div[contains(text(),'IGST (12%)')]/../parent::div//following-sibling::div             |xpath|
|$serviceproviderstate=      |getText;                             |//div[text()='Service provider state']/../following-sibling::div                        |xpath|

!|Script   |common                                                                                                                                                                                                                        |
|check     |checkIfStringAreEqual;|$billtoparty_value                                                                                                                                                           |Source Depot        |true|
|$tresult1=|checkIfStringAreEqual;|$billtoparty_value                                                                                                                                                           |Source Depot             |
|check     |checkIfStringExistsIn;|Marico-auto                                                                                                                                                                  |$billtoparty_address|true|
|check     |checkIfStringExistsIn;|Marico Ltd , c/o Tirumala Oil chem India Pvt. Ltd. , Survey no. 364, Nomula Village, Manchal Mandal, Near Ibrahimpatanam, RR District, Tirumala-Hyderabad, Telengana - 501508|$billtoparty_address|true|
|check     |checkIfStringAreEqual;|$place_of_supply                                                                                                                                                             |Telengana           |true|
|check     |checkIfStringAreEqual;|$gst_method                                                                                                                                                                  |FORWARD             |true|
|check     |checkIfStringExistsIn;|GSTIN: 36AAACM7493G1Z8                                                                                                                                                       |$billtoparty_address|true|
|check     |checkIfStringAreEqual;|$totalinvoicevalue                                                                                                                                                           |49,149.66           |true|
|check     |checkIfStringAreEqual;|$totaltaxablevalue                                                                                                                                                           |45,008.85           |true|
|check     |checkIfStringAreEqual;|$discountvalue                                                                                                                                                               |1125.23             |true|
|check     |checkIfStringAreEqual;|$igst                                                                                                                                                                        |5,266.04            |true|
|check     |checkIfStringAreEqual;|$serviceproviderstate                                                                                                                                                        |Tamil Nadu          |true|
|check     |checkIfStringAreEqual;|$gst_in                                                                                                                                                                      |33AAPCS5550D1ZD     |true|
**!

!**> Generating Invoice in transporter
!define invoice_number {i$unique}
!define remarks {remarks$unique}

!|script                   |Ui                                                                                                                                |
|click;                    |//button[contains(text(),'Summary')]         |xpath                                                                               |
|sendKeys;                 |//input[@placeholder='Enter Invoice Number'] |xpath                                                             |${invoice_number}|
|sendKeys;                 |//textarea                                   |xpath                                                             |${remarks}       |
|wait;                     |2                                                                                                                                 |
|click;                    |//button[contains(text(),'Generate Invoice')]|xpath                                                                               |
|click;                    |//button/span[normalize-space(text())='YES'] |xpath                                                                               |
|waitUntilElementDisplayed;|//div[@role='alert']//h3[text()='Success']   |xpath                                                             |60               |
|$successMessage=          |getElementAttribute;                         |//div[@role='alert']//h3[text()='Success']/following-sibling::span|xpath |innerText |

!include -c .FrontPage.Pando.Common.TransporterLogout

!|Script|Ui|
|wait;  |90|
*!

!** Approve invoice in Shipper 
!define search_text {$unique}

!include -c .FrontPage.Pando.Common.ShipperInvoiceFilter

!include -c .FrontPage.Pando.Common.CommonInvoiceNumberSearchInShipper

!include -c .FrontPage.Pando.Common.CommonInvoiceApprove

!|Script|Ui|
|wait;  |90|
**!

!** Validating freight invoice posting
!|Script              |MongoDBQuery                                                                                                   |
|getMongoConnection;  |${connection}                               |db_pando_testing                                                  |
|$total_invoice_sent1=|getTotalNoOfStrategy1InvoicePostingSent;    |${invoice_number}                                                 |
|$erp_invoice_details=|getStrategy1InvoicePostingPayload;          |${invoice_number}                                                 |
|check                |getValuesFromInvoicePayload;                |transporter_code|401914                                           |
|check                |getValuesFromInvoicePayload;                |invoice_number  |${invoice_number}                                |
|check                |getValuesFromInvoicePayload;                |invoice_total   |43883.62                                         |
|check                |getValuesFromInvoicePayload;                |invoice_date    |$invoicedate                                     |
|check                |getValuesFromInvoicePayload;                |tax_code        |1                                                |
|check                |getValuesFromInvoicePayload;                |tax_type        |1                                                |
|check                |getValuesFromInvoicePayload;                |tax_percentage  |12                                               |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|indent_id              |$order_id         |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|order_reference        |$order_id         |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|movement               |2                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|material_invoice_number|INV-$unique       |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|sku                    |716971            |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|source                 |Tirumala-Hyderabad|
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|source_ref_id          |SHHJ              |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|gate_ref_id            |SHHJ              |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|destination            |Hubli             |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|destination_ref_id     |D677              |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|destination_gate_ref_id|D677              |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|quantity               |200               |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|weight                 |3960              |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|volume                 |225               |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|invoice_value_freight  |10932.95          |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|invoice_value_detention|0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|invoice_value_defect   |47.62             |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|consignee_category     |                  |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|line_item_number       |NA                |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|oda_freight_charge     |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|fixed_charge           |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|additional_point_charge|0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|miscellaneous_charge   |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|loading_charge         |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|unloading_charge       |49.83             |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|lr_charge              |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|sla_delay              |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|transit_delay          |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|penalty                |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|shortage               |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|damage                 |0.16              |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|carton_damage          |47.46             |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|debit_adjustment       |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|extra_km_charge        |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|base_freight_charge    |11211.07          |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|weight_unit            |kg                |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|quantity_unit          |CS                |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |716971|volume_unit            |cft               |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|indent_id              |$order_id         |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|order_reference        |$order_id         |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|movement               |2                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|material_invoice_number|INV-$unique       |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|sku                    |720462            |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|source                 |Tirumala-Hyderabad|
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|source_ref_id          |SHHJ              |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|gate_ref_id            |SHHJ              |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|destination            |Hubli             |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|destination_ref_id     |D677              |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|destination_gate_ref_id|D677              |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|quantity               |250               |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|weight                 |4865              |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|volume                 |281               |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|invoice_value_freight  |13431.5           |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|invoice_value_detention|0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|invoice_value_defect   |58.51             |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|consignee_category     |                  |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|line_item_number       |NA                |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|oda_freight_charge     |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|fixed_charge           |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|additional_point_charge|0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|miscellaneous_charge   |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|loading_charge         |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|unloading_charge       |61.21             |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|lr_charge              |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|sla_delay              |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|transit_delay          |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|penalty                |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|shortage               |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|damage                 |0.2               |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|carton_damage          |58.31             |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|debit_adjustment       |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|extra_km_charge        |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|base_freight_charge    |13773.2           |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|weight_unit            |kg                |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|quantity_unit          |CS                |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |720462|volume_unit            |cft               |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|indent_id              |$order_id         |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|order_reference        |$order_id         |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|movement               |2                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|material_invoice_number|INV-$unique       |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|sku                    |717051            |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|source                 |Tirumala-Hyderabad|
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|source_ref_id          |SHHJ              |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|gate_ref_id            |SHHJ              |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|destination            |Hubli             |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|destination_ref_id     |D677              |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|destination_gate_ref_id|D677              |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|quantity               |350               |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|weight                 |7070              |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|volume                 |562               |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|invoice_value_freight  |19519.17          |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|invoice_value_detention|0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|invoice_value_defect   |85.02             |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|consignee_category     |                  |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|line_item_number       |NA                |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|oda_freight_charge     |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|fixed_charge           |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|additional_point_charge|0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|miscellaneous_charge   |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|loading_charge         |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|unloading_charge       |88.96             |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|lr_charge              |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|sla_delay              |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|transit_delay          |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|penalty                |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|shortage               |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|damage                 |0.29              |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|carton_damage          |84.73             |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|debit_adjustment       |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|extra_km_charge        |0                 |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|base_freight_charge    |20015.73          |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|weight_unit            |kg                |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|quantity_unit          |CS                |
|check                |getIndentsValuesFromStrategy1InvoicePayload;|sku             |717051|volume_unit            |cft               |

!|Script         |Common                                                                  |
|$schemaFilePath=|getPath;|data/schemafiles/strategy1_invoice_posting_schema.json|fullpath|

!|script   |common                                             |
|check     |comparisonResult;|$total_invoice_sent1|equal|1|true|
|$tresult2=|comparisonResult;|$total_invoice_sent1|equal|1     |
*!

!**> Validating the print preview
!|script               |common                    |
|$downloadPath=        |getPath;|download|fullpath|
|cleanFilesInDirectory;|$downloadPath             |

!|Script                     |ui                                                   |
|click;                      |//span[contains(text(),'${invoice_number}')]|xpath   |
|waitForElementToBeDisplayed;|//div[contains(@class,'table__body')]       |xpath|20|
|clickJS;                    |//a[text()='Preview']                       |xpath   |
|wait;                       |10                                                   |

!|script           |common                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|$expected_content=|getTrim;|REMARKS remarks$unique Powered by pando This is an electronic invoice issued in accordance with the provisions of the InformationTechnology Act, 2000 (21 of 2000). Hence, does not require any signature or digital signature PLACE OF SUPPLY: TELENGANA 45008.85 1125.23 5266.04 49149.66 TOTAL TAXABLE VALUE: DISCOUNT (2.5%) TAX IGST 12% TOTAL INVOICE VALUE BILL TO PARTY MARICO-AUTO MARICO LTD , C/O TIRUMALA OIL CHEM INDIA PVT. LTD. , SURVEY NO. 364, NOMULA VILLAGE, MANCHAL MANDAL, NEAR IBRAHIMPATANAM, RR DISTRICT, TIRUMALA-HYDERABAD - 501508, GSTIN : 36AAACM7493G1Z8 SERVICE PROVIDER STATE: TAMIL NADU GST: 33AAPCS5550D1ZD PAN: 27AAPCS5550D1Z6 TAX PAYABLE ON REVERSE CHARGE: NO SERVICE DESCRIPTION: MOVEMENT OF GOODS BY ROAD HSN/SAC: - PO NUMBER: - S SUBHAM FREIGHT CARRIERS INDIA PONDICHERRY - 605101 PONDICHERRY i$unique $todayDate$ordinalDateSuffix $monthAndYear ORIGINAL FOR RECIPIENT TAX INVOICE Indent ID Delivery Mode Vehicle Type Taxable Value $order_id FTL Double Axle 16 MT 45008.85 REMARKS remarks$unique Powered by pando This is an electronic invoice issued in accordance with the provisions of the InformationTechnology Act, 2000 (21 of 2000). Hence, does not require any signature or digital signature PLACE OF SUPPLY: TELENGANA 45008.85 1125.23 5266.04 49149.66 TOTAL TAXABLE VALUE: DISCOUNT (2.5%) TAX IGST 12% TOTAL INVOICE VALUE BILL TO PARTY MARICO-AUTO MARICO LTD , C/O TIRUMALA OIL CHEM INDIA PVT. LTD. , SURVEY NO. 364, NOMULA VILLAGE, MANCHAL MANDAL, NEAR IBRAHIMPATANAM, RR DISTRICT, TIRUMALA-HYDERABAD - 501508, GSTIN : 36AAACM7493G1Z8 SERVICE PROVIDER STATE: TAMIL NADU GST: 33AAPCS5550D1ZD PAN: 27AAPCS5550D1Z6 TAX PAYABLE ON REVERSE CHARGE: NO SERVICE DESCRIPTION: MOVEMENT OF GOODS BY ROAD HSN/SAC: - PO NUMBER: - S SUBHAM FREIGHT CARRIERS INDIA PONDICHERRY - 605101 PONDICHERRY i$unique $todayDate$ordinalDateSuffix $monthAndYear DUPLICATE FOR SUPPLIER TAX INVOICE Indent ID Delivery Mode Vehicle Type Taxable Value $order_id FTL Double Axle 16 MT 45008.85|

!|script       |common                    |
|$downloadPath=|getPath;|download|fullpath|

!|script         |FileUtil                          |
|$filename=      |getLastModifiedFile;|$downloadPath|
|$actual_content=|readPdfFile;        |$filename    |

!|Script            |Common                                                          |
|$difference_in_pdf=|stringCompareForDifference;|$actual_content   |$expected_content|
|check              |checkIfStringAreEqual;     |$difference_in_pdf|[]     |true     |
|$tresult3=         |checkIfStringAreEqual;     |$difference_in_pdf|[]               |

!|script               |common                    |
|$downloadPath=        |getPath;|download|fullpath|
|cleanFilesInDirectory;|$downloadPath             |
*!

!**> Transporter login
!define transporter_email {pandotransporter+delhivery@outlook.com}
!define transporter_password {$password_1}

!include -c .FrontPage.Pando.Common.TransporterLogin
**!

!** Validating Wallet entries in Transporter
!define status_name_wallet {Select All}
!define reason_wallet_1 {RFQ Debit}
!define reason_wallet_2 {SLA Breach - Reassigned}
!define transporter_name {DELHIVERY FREIGHT SERVICES}
!define multiple_reasons {!-//div[contains(@class,'multiselect--active')]//li//span[contains(@class,'multiselect__option')]/span[text()='-!${reason_wallet_1}!-']|//div[contains(@class,'multiselect--active')]//li//span[contains(@class,'multiselect__option')]/span[text()='-!${reason_wallet_2}!-']-!}

!|script     |common                |
|$depot_name=|getTrim;|${depot_name}|

!include -c .FrontPage.Pando.PandoSuites.WalletV2.ListingAndFilter.CommonWalletFilterTransporter

!define search_text {$order_id}
!include -c .FrontPage.Pando.PandoSuites.WalletV2.ListingAndFilter.CommonWalletIndentSearch
*!

!** Validating Wallet amount in transporter 1
!|Script           |Ui                                                                                                                                                                                                                                  |
|check             |isElementPresent;|//*[contains(text(),'$order_id')]//ancestor::div[contains(@class,'col')]//following-sibling::div//span[text()='${reason_wallet_1}']                                                                    |xpath|true|
|$rfqdebitamt=     |getText;         |//*[contains(text(),'$order_id')]//ancestor::div[contains(@class,'col')]//following-sibling::div//span[text()='${reason_wallet_1}']//ancestor::div[contains(@class,'col')]//following-sibling::div/span|xpath     |
|check             |isElementPresent;|//*[contains(text(),'$order_id')]//ancestor::div[contains(@class,'col')]//following-sibling::div//span[text()='${reason_wallet_2}']                                                                    |xpath|true|
|$slareassignedamt=|getText;         |//*[contains(text(),'$order_id')]//ancestor::div[contains(@class,'col')]//following-sibling::div//span[text()='${reason_wallet_2}']//ancestor::div[contains(@class,'col')]//following-sibling::div/span|xpath     |

!|script   |common                                           |
|$tresult4=|checkIfStringAreEqual;|$rfqdebitamt     |23813.48|
|$tresult5=|checkIfStringAreEqual;|$slareassignedamt|1700.00 |
**!

!** Validating Wallet entries in Shipper
!include -c .FrontPage.Pando.PandoSuites.WalletV2.WalletValidationShipper

!define search_text {$order_id}
!include -c .FrontPage.Pando.PandoSuites.WalletV2.ListingAndFilter.CommonWalletIndentSearch

!|Script            |Ui                                                                                                                                                                                                                                    |
|check              |getCountOfElements;|//div[contains(@class,'list-row') or contains(@class,'card-row')]                                                                                                                                      |xpath|2   |
|check              |isElementPresent;  |//*[contains(text(),'$order_id')]//ancestor::div[contains(@class,'col')]//following-sibling::div//span[text()='${reason_wallet_1}']                                                                    |xpath|true|
|$rfqdebitamt2=     |getText;           |//*[contains(text(),'$order_id')]//ancestor::div[contains(@class,'col')]//following-sibling::div//span[text()='${reason_wallet_1}']//ancestor::div[contains(@class,'col')]//following-sibling::div/span|xpath     |
|check              |isElementPresent;  |//*[contains(text(),'$order_id')]//ancestor::div[contains(@class,'col')]//following-sibling::div//span[text()='${reason_wallet_2}']                                                                    |xpath|true|
|$slareassignedamt2=|getText;           |//*[contains(text(),'$order_id')]//ancestor::div[contains(@class,'col')]//following-sibling::div//span[text()='${reason_wallet_2}']//ancestor::div[contains(@class,'col')]//following-sibling::div/span|xpath     |

!|script   |common                                            |
|$tresult6=|checkIfStringAreEqual;|$rfqdebitamt2     |23813.48|
|$tresult7=|checkIfStringAreEqual;|$slareassignedamt2|1700.00 |
**!

!** Change invoice status to Paid
!|Script|Common                                                                                                                                     |
|$data= |getTrim|{"data":[{"reference_number":"i$unique","document_number":"paid$unique","updated_date":"$paydate","document_type":"100","type":3}]}|

!include -c .FrontPage.Pando.PandoSuites.PandoAPI.ERPIntegration.EpodPaidStatus

!|Script       |Ui                                                                                                  |
|navigateToUrl;|${surl}/v2/invoice                                                                                  |
|check         |isElementPresent;|//span[normalize-space(text())='Paid' and starts-with(@class,'status')]|xpath|true|
|$tresult8=    |isElementPresent;|//span[normalize-space(text())='Paid' and starts-with(@class,'status')]|xpath     |
**!

!**> Validating test result
!|script  |common                                                                                                                 |
|check    |checkIfStringAreEqualInArray;|$tresult1,$tresult2,$tresult3,$tresult4,$tresult5,$tresult6,$tresult7,$tresult8,true|true|
|$tresult=|checkIfStringAreEqualInArray;|$tresult1,$tresult2,$tresult3,$tresult4,$tresult5,$tresult6,$tresult7,$tresult8,true     |
*!